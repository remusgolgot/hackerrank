package adventofcode.aoc2023.day13;


import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

public class Main2 {

    static String s =
            "#.##..##.\n" +
                    "..#.##.#.\n" +
                    "##......#\n" +
                    "##......#\n" +
                    "..#.##.#.\n" +
                    "..##..##.\n" +
                    "#.#.##.#.\n" +
                    "\n" +
                    "#...##..#\n" +
                    "#....#..#\n" +
                    "..##..###\n" +
                    "#####.##.\n" +
                    "#####.##.\n" +
                    "..##..###\n" +
                    "#....#..#";

    static String sq = ".##...#..##\n" +
            ".....##...#\n" +
            "#..#..###..\n" +
            "#..#####..#\n" +
            "####.##.##.\n" +
            "####.##.##.\n" +
            "#..#####..#\n" +
            "#..##.###..\n" +
            ".....##...#\n" +
            ".##...#..##\n" +
            ".##..#.##.#\n" +
            "........###\n" +
            ".....#...#.\n" +
            "....#.#.##.\n" +
            "#..##..###.\n" +
            "#..###..#.#\n" +
            "#..#...#.##\n" +
            "\n" +
            "##....##.#.\n" +
            "##.##.#..#.\n" +
            "..####....#\n" +
            "#######..##\n" +
            "##..#......\n" +
            "...##......\n" +
            "###....##..\n" +
            "..#.#..##..\n" +
            "...#.#....#\n" +
            "..##.......\n" +
            "..##.#.##.#\n" +
            "##...##..##\n" +
            "######.##.#\n" +
            "###...#..#.\n" +
            "...###....#\n" +
            "..##.......\n" +
            "###.##....#\n" +
            "\n" +
            ".#.#....#.#.###\n" +
            "...#....#...#..\n" +
            "....####....#..\n" +
            ".#.######.#..##\n" +
            "###..##..###...\n" +
            ".#...##...#.###\n" +
            "..##....##.....\n" +
            ".#...##...#..##\n" +
            "..##....##..#..\n" +
            ".##########....\n" +
            "##.#.##.#.##...\n" +
            "....####.....##\n" +
            "##...##...##.##\n" +
            "##.#.##.#.##.##\n" +
            "...#....#...###\n" +
            "##...##...#####\n" +
            "....#..........\n" +
            "\n" +
            "######.###.#..#\n" +
            ".....#.####.#..\n" +
            ".....#.####.#..\n" +
            "######.###.##.#\n" +
            ".###..#.#....##\n" +
            ".###..#.#....##\n" +
            "######.###.##.#\n" +
            ".....#.####.#..\n" +
            ".....#.####.#..\n" +
            "######.###.#..#\n" +
            ".#.#######.##..\n" +
            ".....#..##.#.#.\n" +
            "###....##.##...\n" +
            ".#..#..#...####\n" +
            ".#...#..#.#....\n" +
            "\n" +
            "..#.#....#....#\n" +
            "..#.#....#....#\n" +
            "..##.#..#..##..\n" +
            "#.#.##.#.#.##.#\n" +
            "####.###.#.##.#\n" +
            ".####.######.##\n" +
            "##.#....#.####.\n" +
            ".####.###.#..#.\n" +
            "#..##...#.#..#.\n" +
            "\n" +
            "###....##\n" +
            "####..###\n" +
            "##.#..#.#\n" +
            "....##...\n" +
            "##.#..#.#\n" +
            "##.####.#\n" +
            "..##..##.\n" +
            "...#..#..\n" +
            "..##..##.\n" +
            "..######.\n" +
            "####..##.\n" +
            "\n" +
            "..#.###.#...#..\n" +
            "###.##.#...####\n" +
            "..#.#..#.....##\n" +
            "..##........##.\n" +
            "...#..#.###.#..\n" +
            "...#..#.###.#..\n" +
            "..#.........##.\n" +
            "\n" +
            ".#..##..#.##.\n" +
            ".##.##.##....\n" +
            "..######..##.\n" +
            "...#..#......\n" +
            "#.#.##.#.####\n" +
            ".#..##..#####\n" +
            ".#.#..#.#....\n" +
            "##.#..#.##..#\n" +
            "..#....#.....\n" +
            "\n" +
            ".##..##.####...\n" +
            ".##..##..#.###.\n" +
            "#..##..#.##.#.#\n" +
            ".######.#..#...\n" +
            "#..##..###...##\n" +
            "#..##..####.#.#\n" +
            "#..##..###.#..#\n" +
            "\n" +
            ".###.#..#.#.#.#\n" +
            "#.##.#..##..#.#\n" +
            ".#.#.##.##..###\n" +
            ".#.#.##.##..###\n" +
            "#.##.#..##..#.#\n" +
            ".#####..#.#.#.#\n" +
            "....#...#.##...\n" +
            "#..##..#..###..\n" +
            ".#.#.#.####.###\n" +
            "####.#...#..#.#\n" +
            "#.#.#.###.###..\n" +
            "#.#.#.###.###..\n" +
            "####.#...#..#.#\n" +
            "\n" +
            "........#..#....#\n" +
            "############.....\n" +
            "#########.##.....\n" +
            "........#..#....#\n" +
            ".######..##..#.#.\n" +
            ".##..##..#..#####\n" +
            "........##..#####\n" +
            "#.#..#.#..#...#..\n" +
            "#......#.#..#.##.\n" +
            "##....##...##.##.\n" +
            "#.#..#.#.#.##..##\n" +
            "\n" +
            "#..#...\n" +
            "#..####\n" +
            "####.#.\n" +
            "####.#.\n" +
            "####.#.\n" +
            "####.#.\n" +
            "#..####\n" +
            "#..#...\n" +
            ".##.###\n" +
            ".##.#..\n" +
            "####..#\n" +
            "#####..\n" +
            "...####\n" +
            "#..##..\n" +
            ".##.##.\n" +
            "#..#.#.\n" +
            "#..#..#\n" +
            "\n" +
            ".##...#####\n" +
            "....##..##.\n" +
            "##.#..##..#\n" +
            "######.....\n" +
            "####..#####\n" +
            ".##.###.##.\n" +
            "........##.\n" +
            ".....#..##.\n" +
            ".##.#.#....\n" +
            "....#......\n" +
            "#..#.#.#..#\n" +
            ".......#..#\n" +
            ".##........\n" +
            "\n" +
            "#..####.#####\n" +
            "#..##....####\n" +
            ".##.#.####.##\n" +
            ".##.###..#...\n" +
            "#..#####..#..\n" +
            ".##.##.#.#...\n" +
            ".##..#.##....\n" +
            "######..#.#..\n" +
            "#..#..##.####\n" +
            ".....#....###\n" +
            ".##...##.#...\n" +
            "#..#.#.#.....\n" +
            ".....#.####..\n" +
            "#..#...##..##\n" +
            ".....#.####..\n" +
            ".##.#..######\n" +
            ".##.........#\n" +
            "\n" +
            "#....#..###\n" +
            ".##.###.#..\n" +
            "....#...#..\n" +
            "#.#.##.#...\n" +
            "#.####.#.##\n" +
            "##..#.#.###\n" +
            "##..#.#.###\n" +
            "#.####.#.##\n" +
            "#.#.##.#...\n" +
            "....#...#..\n" +
            ".##.###.#..\n" +
            "#....#..###\n" +
            "#.#.#..##..\n" +
            ".#.##.##..#\n" +
            "####..#.#..\n" +
            "\n" +
            "#.#########\n" +
            ".#.....#..#\n" +
            "##.#..#....\n" +
            "##.#..#....\n" +
            ".#.....#..#\n" +
            "#.#########\n" +
            "###....#...\n" +
            "\n" +
            "#.##.#.\n" +
            "#.####.\n" +
            "..#...#\n" +
            "...#...\n" +
            ".#.#.#.\n" +
            ".#.#.#.\n" +
            "...#...\n" +
            "..#...#\n" +
            "#.####.\n" +
            "\n" +
            "##.####\n" +
            "######.\n" +
            "######.\n" +
            "######.\n" +
            "######.\n" +
            "..##...\n" +
            "#.##.##\n" +
            "#....#.\n" +
            "#....#.\n" +
            "\n" +
            "#.#.#..#.#.#.\n" +
            "#..#.##.#..#.\n" +
            ".###.##.###.#\n" +
            "...#.##.#...#\n" +
            "...#.##.#...#\n" +
            ".###.##.###.#\n" +
            "#..#.##.#..#.\n" +
            "#.#.#..#.#.#.\n" +
            "...##..##....\n" +
            "#.#......#.##\n" +
            "##.#.##.#.##.\n" +
            "#..######..#.\n" +
            ".##......##.#\n" +
            ".##.####.##..\n" +
            ".#.##.###.#..\n" +
            "\n" +
            ".....#..##.##\n" +
            ".....#..##.##\n" +
            "..#..###...#.\n" +
            ".##..###.#...\n" +
            "#.#.#####.##.\n" +
            "#...###.####.\n" +
            "#..###...###.\n" +
            "...#..####...\n" +
            "###.#.#.#.#.#\n" +
            "##.#.##..#...\n" +
            "####...#..#.#\n" +
            ".#..#####.#..\n" +
            ".#..#####.#..\n" +
            "####...#..#.#\n" +
            "##.#.##..#...\n" +
            "###.#.#.#.#.#\n" +
            ".#.#..####...\n" +
            "\n" +
            "#####.##....###\n" +
            "##.##.##....###\n" +
            "##.##.##....###\n" +
            "#####.##....###\n" +
            ".####.#.....#.#\n" +
            "#..#..#...#..##\n" +
            "###...####.#.#.\n" +
            "..####.#.##.#..\n" +
            "#.#.##...##..##\n" +
            "....##.#.######\n" +
            "...##..##..#.#.\n" +
            "...#..#.#..###.\n" +
            "#..#.#.#...#.##\n" +
            ".##.#.#..##.##.\n" +
            "...###..##.#..#\n" +
            "####.#.#.#....#\n" +
            "#...#.#..#...##\n" +
            "\n" +
            "..######.\n" +
            ".####.###\n" +
            "..#....#.\n" +
            "#.######.\n" +
            "#.######.\n" +
            "...####..\n" +
            "...#..#..\n" +
            ".##....##\n" +
            ".##....##\n" +
            "\n" +
            ".#.#.##...#.#\n" +
            "..#.##.....#.\n" +
            "#...#..#.####\n" +
            "#...#..#.####\n" +
            "..#.##....##.\n" +
            ".#.#.##...#.#\n" +
            "..###.#.#...#\n" +
            ".#.#..###....\n" +
            ".#..###.#....\n" +
            "..##.#..###.#\n" +
            "##.####.###..\n" +
            "####...######\n" +
            "###...##.#.##\n" +
            "###...##.#.##\n" +
            "####...######\n" +
            "##.####.###..\n" +
            "..##.#..###.#\n" +
            "\n" +
            "..#....##.#\n" +
            ".....#.#..#\n" +
            ".....#.#..#\n" +
            "..#.....#.#\n" +
            "###..#.####\n" +
            ".###...##..\n" +
            "#.###.###..\n" +
            "###.###.###\n" +
            "###.#..##..\n" +
            "#.##.###...\n" +
            "#.#.#..####\n" +
            ".#.#.##..#.\n" +
            "#####.##..#\n" +
            "#.#######..\n" +
            "#.#######..\n" +
            "#####.##..#\n" +
            ".#.#.##..#.\n" +
            "\n" +
            "##.##..##\n" +
            "#.##.##.#\n" +
            "##.#..#.#\n" +
            ".#..####.\n" +
            ".#..#..#.\n" +
            "#..######\n" +
            ".#..#..#.\n" +
            "##..#..#.\n" +
            ".#.######\n" +
            "#...####.\n" +
            ".##......\n" +
            ".##......\n" +
            "#...####.\n" +
            ".#.######\n" +
            "##..#..#.\n" +
            "\n" +
            "...#....#....\n" +
            "####....#####\n" +
            "#..#.##....##\n" +
            "#.#..##..#.##\n" +
            "###.#..#.####\n" +
            "##........###\n" +
            "#..#.##.#..##\n" +
            ".##.####.##..\n" +
            ".####..####..\n" +
            "\n" +
            "###..###.######.#\n" +
            "###..####.####.##\n" +
            "........#.#..#.#.\n" +
            "...##...########.\n" +
            "#.####.##########\n" +
            "#..##..###....###\n" +
            ".#....#...##.#...\n" +
            "\n" +
            "...##...####.\n" +
            "#.####.#.##.#\n" +
            ".######.#..#.\n" +
            "#.######....#\n" +
            "........#..#.\n" +
            "########.##.#\n" +
            "########....#\n" +
            "#########..##\n" +
            ".##..##..##..\n" +
            "#......##..##\n" +
            ".######..##..\n" +
            "########....#\n" +
            ".######......\n" +
            "###..########\n" +
            "##.##.##.##.#\n" +
            "\n" +
            "##..#..##..#.\n" +
            "..#.#......#.\n" +
            "......#..#...\n" +
            "....##....##.\n" +
            "..#.#......#.\n" +
            "...####..####\n" +
            "##..#..##..#.\n" +
            "......#..#...\n" +
            "......#..#...\n" +
            "###.###..###.\n" +
            "##.#...###..#\n" +
            "\n" +
            "####.####\n" +
            ".#.......\n" +
            ".#.......\n" +
            "#.##.####\n" +
            "..#.....#\n" +
            "..#.....#\n" +
            "#.##.####\n" +
            ".#.......\n" +
            ".#.......\n" +
            "####.####\n" +
            "..#.#..##\n" +
            "####.....\n" +
            "#.....###\n" +
            "\n" +
            "...#..#...#..\n" +
            "...#..#...#..\n" +
            "#.##..##.#..#\n" +
            "....##......#\n" +
            "####..####.##\n" +
            "..######.....\n" +
            "##.####.###..\n" +
            "#...##...####\n" +
            "#...##...#.#.\n" +
            "#..#..#..#..#\n" +
            "#.#.##.#####.\n" +
            "..#....#...#.\n" +
            "...####...#..\n" +
            "#........#.#.\n" +
            "...#..#...#..\n" +
            "#.#....#.#.#.\n" +
            "#..####..####\n" +
            "\n" +
            "...###.#...#.##\n" +
            "...###.#...#.##\n" +
            "..##.....#.##..\n" +
            "#...#....##.#.#\n" +
            "...###......#.#\n" +
            "####.#.#..#.#..\n" +
            "..##....##.#.#.\n" +
            ".#..###.##..###\n" +
            "##.###.#..##..#\n" +
            ".#.#...##.#...#\n" +
            "...#..###..##..\n" +
            "#...##.#.######\n" +
            "###.####.#.....\n" +
            "#..#.#.#.#...#.\n" +
            "#..#.#.#.#...##\n" +
            "###.####.#.....\n" +
            "#...##.#.######\n" +
            "\n" +
            "##.#.#.##..##.#\n" +
            "##.#####....###\n" +
            "##.#...##..##..\n" +
            "##.###.##..##.#\n" +
            ".....#.######.#\n" +
            "..##.#..#..#..#\n" +
            "######.#....#.#\n" +
            "..#.....#..#...\n" +
            "##.###...##....\n" +
            "\n" +
            "####..#..\n" +
            "#...#...#\n" +
            "###.##.##\n" +
            "##...#.##\n" +
            ".#.#.##..\n" +
            ".#.#.##..\n" +
            "##...#.##\n" +
            "\n" +
            "...##....#..#\n" +
            "##....##.#.##\n" +
            ".........####\n" +
            "########.....\n" +
            "##.##.##.####\n" +
            "#########..##\n" +
            "#..##..#.#.#.\n" +
            ".........#...\n" +
            "##....####..#\n" +
            "...##.....#..\n" +
            "........####.\n" +
            "##....##..#..\n" +
            "########..###\n" +
            "\n" +
            "#.#.#..#.\n" +
            "..##.##.#\n" +
            "..##..#.#\n" +
            "#..####.#\n" +
            ".##.#..#.\n" +
            ".##.#..#.\n" +
            "#..####.#\n" +
            "...#..#.#\n" +
            "..##.##.#\n" +
            "#.#.#..#.\n" +
            "####..###\n" +
            "...#..#.#\n" +
            "####...##\n" +
            "####...##\n" +
            "...#..#.#\n" +
            "####..###\n" +
            "#.#.#..#.\n" +
            "\n" +
            "...######....##\n" +
            "#..#.##.#..####\n" +
            "###..##..###...\n" +
            "#..#....#..##..\n" +
            "..##.##.##...##\n" +
            "##.#....#.###..\n" +
            ".##########.#..\n" +
            "...######...###\n" +
            "#..##..##..##..\n" +
            ".#.#.##.#......\n" +
            "##.##..##.###..\n" +
            "\n" +
            "....#..\n" +
            "..#....\n" +
            "..####.\n" +
            "..#.##.\n" +
            "..#.##.\n" +
            "..####.\n" +
            "..##...\n" +
            "....#..\n" +
            "##..#..\n" +
            "##...##\n" +
            "..#####\n" +
            "\n" +
            "....#..#...\n" +
            "##.######.#\n" +
            "##...##...#\n" +
            "..########.\n" +
            "#..#.##.#..\n" +
            "#.#..##..#.\n" +
            "#.#..##..#.\n" +
            "...#.##.#..\n" +
            "..########.\n" +
            "##...##...#\n" +
            "##.######.#\n" +
            "....#..#...\n" +
            "#.#......#.\n" +
            "#.########.\n" +
            "..########.\n" +
            "##........#\n" +
            "..##.##.##.\n" +
            "\n" +
            "##.#.#..#....\n" +
            "#..#....#####\n" +
            "##..##..#....\n" +
            "##.###.#..##.\n" +
            "##..####.#..#\n" +
            "#.##..##..##.\n" +
            ".#.#.#..#....\n" +
            "......##.####\n" +
            ".##.##.######\n" +
            "####.##..####\n" +
            "#.##...#.....\n" +
            "#..###.##....\n" +
            "...###.##....\n" +
            "#.##...#.....\n" +
            "####.##..####\n" +
            "\n" +
            "...##..#.\n" +
            "...##....\n" +
            "###.##.#.\n" +
            "....#.#..\n" +
            "###.####.\n" +
            "...##..#.\n" +
            "##...##..\n" +
            "....###..\n" +
            "....##..#\n" +
            "\n" +
            "#.##..####.\n" +
            "#.#...####.\n" +
            "###....###.\n" +
            "#....###..#\n" +
            "###.#...###\n" +
            "###.#...###\n" +
            "#....###..#\n" +
            "###....###.\n" +
            "#.#...####.\n" +
            "#.##..####.\n" +
            "#.#.#...###\n" +
            "#.#####.#.#\n" +
            ".#..##.#.#.\n" +
            "\n" +
            "..#...#..##\n" +
            "##.####....\n" +
            "..#.#..#.##\n" +
            "###..##..##\n" +
            "##...#.###.\n" +
            "......##.#.\n" +
            "......##.#.\n" +
            "##...#.####\n" +
            "###..##..##\n" +
            "\n" +
            "###....####.##.\n" +
            ".##...###.###.#\n" +
            "#.#.##.#.#..##.\n" +
            "##########.#..#\n" +
            "..........###..\n" +
            ".##....##......\n" +
            "#...##...##.###\n" +
            "#...##...##.###\n" +
            ".##....##......\n" +
            "\n" +
            "...####.#..#..#\n" +
            "##..###.##..##.\n" +
            "##..###.##..##.\n" +
            "...####.#..#..#\n" +
            "###.###...#.##.\n" +
            "..#...#....#..#\n" +
            "#...##..#..#..#\n" +
            "..#......######\n" +
            "#...###...##..#\n" +
            ".#.##..#.###..#\n" +
            "....##.##..##.#\n" +
            "\n" +
            ".#..###\n" +
            "#.#..##\n" +
            "##.####\n" +
            "#...###\n" +
            "#.##...\n" +
            "..#.#..\n" +
            "..##..#\n" +
            "##.#...\n" +
            "##.#...\n" +
            "\n" +
            "....#....#.....\n" +
            "..###....###...\n" +
            "#....####....##\n" +
            "##..##..##..###\n" +
            "###..#..#..##..\n" +
            "#...#....#...##\n" +
            ".#.##.##.##.#..\n" +
            "######..#######\n" +
            "##..##..##..###\n" +
            "....######.....\n" +
            "###.##..##.####\n" +
            "..##.####.##...\n" +
            "###.#....#.####\n" +
            "\n" +
            "#..##..##\n" +
            "..#..##..\n" +
            ".#.#.##.#\n" +
            ".#.#.##.#\n" +
            "..#..##..\n" +
            "#..##..##\n" +
            ".##..##..\n" +
            "##.#.##.#\n" +
            "...######\n" +
            "..#.####.\n" +
            "###.....#\n" +
            ".####..##\n" +
            "#...####.\n" +
            "\n" +
            "##.###..#..#..#\n" +
            ".#.###..#..#..#\n" +
            ".###.#.#....#.#\n" +
            ".##...########.\n" +
            ".#..#.#......#.\n" +
            ".#.#####.##.###\n" +
            "#..###...##...#\n" +
            "##.#..########.\n" +
            "#..#.###....###\n" +
            "\n" +
            ".###..###.#\n" +
            "#..#..##.#.\n" +
            ".#.#..#.#.#\n" +
            ".###..###..\n" +
            ".##.##.##..\n" +
            "#..#..#..#.\n" +
            "#..#..#..#.\n" +
            ".##.##.##..\n" +
            ".###..###..\n" +
            "\n" +
            "..#.#####.#.##.\n" +
            "..####.#...#.##\n" +
            "...#..#.####..#\n" +
            "...###.###..###\n" +
            "##.#####.......\n" +
            "##.#####.#.....\n" +
            "...###.###..###\n" +
            "\n" +
            "#...#.####.#.\n" +
            "#...#.####.#.\n" +
            "..##..#..#..#\n" +
            "##.#.##..##.#\n" +
            "..#.#.#..#.#.\n" +
            "#.###########\n" +
            "##..#........\n" +
            "..#..##..##..\n" +
            "#.#.#......#.\n" +
            "\n" +
            "...#..#....##\n" +
            "##.#..#.###..\n" +
            "#.######.#...\n" +
            "#.#.##.#.####\n" +
            "###....###.##\n" +
            "..........###\n" +
            "...#..#...#..\n" +
            "#........#...\n" +
            ".########.###\n" +
            "...#..#....##\n" +
            "##..##..#####\n" +
            ".#...#..#..##\n" +
            "##########...\n" +
            "\n" +
            ".#####.########\n" +
            "#.###..#.#.####\n" +
            "##.#...##.#....\n" +
            "##..######.....\n" +
            "..###.#..###..#\n" +
            "...#..#.#......\n" +
            ".#..#...#..####\n" +
            "##.......#.....\n" +
            "###.#.#####....\n" +
            "\n" +
            "..#.##.#.\n" +
            "..#.##.#.\n" +
            "#.###.##.\n" +
            "#..##....\n" +
            ".#.#..#.#\n" +
            ".#.#.##.#\n" +
            "###.##.#.\n" +
            "####..#..\n" +
            "..###..#.\n" +
            "#.#...##.\n" +
            "#.#...##.\n" +
            "..###..#.\n" +
            "###...#..\n" +
            "###.##.#.\n" +
            ".#.#.##.#\n" +
            "\n" +
            "#..##..##\n" +
            "#..##..##\n" +
            "#..#####.\n" +
            "####..#..\n" +
            ".#.......\n" +
            ".#.......\n" +
            "####..#..\n" +
            "#..#####.\n" +
            "#.###..##\n" +
            "\n" +
            ".##.#....#.#.####\n" +
            ".##.#....#...####\n" +
            "#####.##...###.##\n" +
            ".##..#.##.....###\n" +
            "#####.#.###..#...\n" +
            "####.####.##..##.\n" +
            ".##..#..#.##.####\n" +
            ".##....##..####.#\n" +
            ".....#..###.#.#.#\n" +
            "....#.#.##..##.#.\n" +
            "....#.#..#.#.#...\n" +
            "\n" +
            "###..##..\n" +
            "##.#....#\n" +
            "...####.#\n" +
            "##.#....#\n" +
            "..###..##\n" +
            "..#.#..#.\n" +
            "..###..##\n" +
            "\n" +
            ".##..#...\n" +
            ".#.#.##..\n" +
            "##.#.....\n" +
            "#..####..\n" +
            ".##.#####\n" +
            "#...##...\n" +
            "#.#.##.##\n" +
            "#.#.##.##\n" +
            "#...##...\n" +
            "###.#####\n" +
            "#..####..\n" +
            "##.#.....\n" +
            ".#.#.##..\n" +
            "\n" +
            "....#....#...\n" +
            "..##.####.##.\n" +
            "#....#..#....\n" +
            "##..##..##.##\n" +
            "...#..##..#..\n" +
            "#.#.#....#.#.\n" +
            "###.##..##.##\n" +
            "###.##..##.##\n" +
            "#.#.#....#.#.\n" +
            "\n" +
            ".##.#..##\n" +
            "#..###..#\n" +
            "#..#####.\n" +
            "########.\n" +
            "#..#.#.#.\n" +
            "#..#.#.#.\n" +
            "########.\n" +
            "#..#####.\n" +
            "#..####.#\n" +
            "\n" +
            ".#.....####....\n" +
            "..#..#......#..\n" +
            "..#.##..##..##.\n" +
            ".##....#..#....\n" +
            "...####.##.####\n" +
            "#...##.#..#.##.\n" +
            "#..############\n" +
            ".#.####....####\n" +
            ".##....####....\n" +
            "\n" +
            "#...#.#....#.\n" +
            "#...#.#....#.\n" +
            "#..###.####.#\n" +
            "##..###.##.##\n" +
            ".#.#.#.#..#.#\n" +
            "#...#########\n" +
            "##.#.#.#.##.#\n" +
            "##..#...##...\n" +
            ".#..##.####.#\n" +
            "#.##.########\n" +
            "...###..##..#\n" +
            "##.##...##...\n" +
            ".#.###.#..#.#\n" +
            "\n" +
            "##......#\n" +
            "#........\n" +
            "#.#.##.#.\n" +
            ".###..###\n" +
            "###....##\n" +
            "##......#\n" +
            "..#....#.\n" +
            "#.#....#.\n" +
            "##......#\n" +
            "###....##\n" +
            ".###..###\n" +
            "#.#.##.#.\n" +
            "#........\n" +
            "##......#\n" +
            "..######.\n" +
            ".#.####.#\n" +
            "###.##.##\n" +
            "\n" +
            "#..#.##.#..\n" +
            "#..#.##.#..\n" +
            "###.####.##\n" +
            ".##....#.##\n" +
            "#...#..#...\n" +
            "..#.#..#.#.\n" +
            "..##....##.\n" +
            "\n" +
            ".#...##\n" +
            "#.#.##.\n" +
            "..#.#.#\n" +
            ".#..###\n" +
            "##.....\n" +
            "##.....\n" +
            ".#..###\n" +
            "..#.#.#\n" +
            "#.#.##.\n" +
            ".#...##\n" +
            "##.....\n" +
            "##.#..#\n" +
            "..#.##.\n" +
            "##.#...\n" +
            "#..#...\n" +
            "\n" +
            "..##..######.\n" +
            ".###..#....#.\n" +
            ".#.###.#..#.#\n" +
            "#..#...#.##..\n" +
            "...#.#.####.#\n" +
            "###.#.######.\n" +
            ".......####..\n" +
            "..#..#......#\n" +
            "########..###\n" +
            "########..###\n" +
            "..#..#......#\n" +
            "\n" +
            ".#..##.#.##.#\n" +
            ".#..#..#.##.#\n" +
            "#.###.#..##..\n" +
            "..##..#.####.\n" +
            "....####....#\n" +
            "#....#.#....#\n" +
            ".#####..#..#.\n" +
            "\n" +
            ".#.##....##.#....\n" +
            "##.#.#..#.#.####.\n" +
            "###.#.##.#.######\n" +
            ".###..##..###..##\n" +
            "#..#.#..#.#..##..\n" +
            "....##..##.......\n" +
            ".#.##.##.##.#..#.\n" +
            "\n" +
            "..##......##.\n" +
            "..##..##..##.\n" +
            "......##.....\n" +
            "..###.##.###.\n" +
            "..###....###.\n" +
            "###.##..##.#.\n" +
            "###..####..##\n" +
            "###........##\n" +
            "####......###\n" +
            "\n" +
            "#.#....#.#.##\n" +
            ".##..##..##.#\n" +
            "#.#......#.#.\n" +
            "#..#.##.#..#.\n" +
            ".#...##...#.#\n" +
            "##.######.###\n" +
            "###......####\n" +
            ".....##......\n" +
            "#..#....#..##\n" +
            "#..#....#..##\n" +
            ".....##......\n" +
            "###......####\n" +
            "##.######.###\n" +
            ".#...##...#.#\n" +
            "#..#.##.#..#.\n" +
            "\n" +
            ".#..#..#.#....#\n" +
            "#.##.###......#\n" +
            ".####...#.##.##\n" +
            "......#.##...##\n" +
            "#....###..#.#..\n" +
            "..##..###.#####\n" +
            "#########..#..#\n" +
            "#########..#..#\n" +
            "..##..##..#####\n" +
            "#....###..#.#..\n" +
            "......#.##...##\n" +
            ".####...#.##.##\n" +
            "#.##.###......#\n" +
            "\n" +
            "#...###\n" +
            "#..##.#\n" +
            ".#..##.\n" +
            "#.###..\n" +
            "#.###..\n" +
            ".#..##.\n" +
            "##.##.#\n" +
            "#...###\n" +
            "###.##.\n" +
            ".#....#\n" +
            "###....\n" +
            "..#...#\n" +
            "###.###\n" +
            "###.###\n" +
            "..#...#\n" +
            "\n" +
            "##..#####\n" +
            "##..#####\n" +
            ".......#.\n" +
            "##..##...\n" +
            "#.##.#..#\n" +
            "#######..\n" +
            ".#..#.#.#\n" +
            "#.##.####\n" +
            ".####.#..\n" +
            ".......#.\n" +
            "#.#####.#\n" +
            "\n" +
            "##########...#.##\n" +
            "#.##..##.#...####\n" +
            "#.######.#.####..\n" +
            "..........#.#.#..\n" +
            "###.##.####....##\n" +
            "###....####..####\n" +
            "##.####.##.##..##\n" +
            "####..#######....\n" +
            "..#.##.#...####..\n" +
            "####..########.##\n" +
            "...####...###..#.\n" +
            "\n" +
            "#..###..#...#.#\n" +
            "#..###.##...#.#\n" +
            "#..###.##...#.#\n" +
            "#..###..#...#.#\n" +
            ".#.##.##....#.#\n" +
            ".###.#...#.#...\n" +
            "..#....##.#..##\n" +
            ".#.###..#..####\n" +
            "...####.#...#.#\n" +
            ".#.##..#.#.#..#\n" +
            "#.#.##.#.##.###\n" +
            ".#####.#..##..#\n" +
            ".#.#.##.##.####\n" +
            "\n" +
            ".######..##\n" +
            "..#..#..###\n" +
            ".#.##.#.###\n" +
            ".#.##.#.#..\n" +
            "########...\n" +
            "..###....##\n" +
            "#.#..#.#.##\n" +
            ".##..##....\n" +
            "########.##\n" +
            "########...\n" +
            ".#....#....\n" +
            "\n" +
            "##..#.###\n" +
            "#...#.###\n" +
            "#....##..\n" +
            "#....##..\n" +
            "#...#.###\n" +
            "##..#.###\n" +
            "##...#.#.\n" +
            "...##.##.\n" +
            ".##..#...\n" +
            "####..#.#\n" +
            "#..#..#.#\n" +
            ".#..#.#..\n" +
            ".#####.##\n" +
            "##..#.#.#\n" +
            "..####.#.\n" +
            ".#.#.....\n" +
            "##..#.###\n" +
            "\n" +
            "...#####.####.###\n" +
            "###..#.#.#..#.#.#\n" +
            ".##...#........#.\n" +
            ".##...#........#.\n" +
            "###..#.#.#..#.#.#\n" +
            "...#####.####.###\n" +
            "..#.....#....#.#.\n" +
            "\n" +
            "#.#.#..#.######.#\n" +
            ".#.......##..##..\n" +
            ".#.......##..##..\n" +
            "#.#....#.######.#\n" +
            "...####.#.#..#.#.\n" +
            "#.#..#..########.\n" +
            "....#.#.#..##..#.\n" +
            "\n" +
            "..##...\n" +
            "#.#.#..\n" +
            "#.#.#..\n" +
            "..##...\n" +
            "###.#..\n" +
            "...####\n" +
            "##.####\n" +
            "...###.\n" +
            "#...#..\n" +
            "..##...\n" +
            ".#..###\n" +
            "..#....\n" +
            "..##.##\n" +
            "\n" +
            "####.....\n" +
            "..#...###\n" +
            "....##.##\n" +
            "#..##.###\n" +
            ".##..####\n" +
            "#.....#..\n" +
            "#.#####..\n" +
            "####...##\n" +
            "####...##\n" +
            "#.#.###..\n" +
            "#.....#..\n" +
            "\n" +
            "......#.##.#...\n" +
            "####..######..#\n" +
            "#..####.#..####\n" +
            "....##..##..##.\n" +
            ".##.#..####..#.\n" +
            "####....##....#\n" +
            ".##.##......##.\n" +
            ".##..########..\n" +
            "#..#....##....#\n" +
            ".##..##.##.##..\n" +
            "....#.#....#.#.\n" +
            ".##...#.##.#...\n" +
            "#####.#.##.#.##\n" +
            "#..#.#..##..#.#\n" +
            ".##.....##.....\n" +
            "\n" +
            "###..##..\n" +
            ".#..##...\n" +
            ".#.#.#.##\n" +
            "...#..###\n" +
            "..##.#...\n" +
            "#..##....\n" +
            "..#...#..\n" +
            "..#...#..\n" +
            "#..##....\n" +
            "..##.#...\n" +
            "...##.###\n" +
            ".#.#.#.##\n" +
            ".#..##...\n" +
            "###..##..\n" +
            "#.#..####\n" +
            "\n" +
            "###.###\n" +
            ".#.##..\n" +
            ".#.##..\n" +
            "#.#....\n" +
            "####.##\n" +
            "#....##\n" +
            "##.#.##\n" +
            "###.#..\n" +
            ".#.#.##\n" +
            "...#...\n" +
            ".#.#...\n" +
            "###....\n" +
            "...#...\n" +
            "...#...\n" +
            "###....\n" +
            ".#.....\n" +
            "...#...\n" +
            "\n" +
            "##...##....##\n" +
            "#....#..##..#\n" +
            "#..###.#..#.#\n" +
            "#...#.##..##.\n" +
            "#..###..##..#\n" +
            "..#..#..##..#\n" +
            "###..#.####.#\n" +
            "#.#.####...##\n" +
            "...#..#.##.#.\n" +
            "##.##.#....#.\n" +
            ".##...#.##.#.\n" +
            "....#.######.\n" +
            "###.....##...\n" +
            "#..##########\n" +
            "....#..#..#..\n" +
            "......######.\n" +
            "......######.\n" +
            "\n" +
            ".#.....\n" +
            "......#\n" +
            ".####..\n" +
            ".####..\n" +
            "#....#.\n" +
            ".####.#\n" +
            "##..###\n" +
            "##..###\n" +
            ".####.#\n" +
            "#....#.\n" +
            ".####..\n" +
            "\n" +
            "........##...\n" +
            "........#.#.#\n" +
            "...##........\n" +
            "##########.#.\n" +
            ".##..##..#...\n" +
            "########...##\n" +
            "........#....\n" +
            ".##..##.#.#..\n" +
            "#..##..###..#\n" +
            "\n" +
            "#.##...####..#.##\n" +
            ".#..###.###.#..##\n" +
            ".##...#....#...##\n" +
            ".##...#....#...##\n" +
            ".#..###.###.##.##\n" +
            "#.##...####..#.##\n" +
            "#..####..##.##.##\n" +
            ".#...#....##.#.##\n" +
            ".##..###..#####..\n" +
            "\n" +
            "......###\n" +
            "#..#.#...\n" +
            ".##...###\n" +
            "#..#...##\n" +
            ".##..##.#\n" +
            "####.##..\n" +
            ".##.##...\n" +
            ".##.#..##\n" +
            "####.....\n" +
            "......###\n" +
            ".##.##.##\n" +
            "\n" +
            ".####...##.\n" +
            "..##....#..\n" +
            "..##....#..\n" +
            ".####...##.\n" +
            "..##.....##\n" +
            "########...\n" +
            "..##..#..#.\n" +
            ".......####\n" +
            ".......#.#.\n" +
            ".####.###..\n" +
            "#.##.##...#\n" +
            "#######....\n" +
            "#.##.##...#\n" +
            ".####.####.\n" +
            "#.##.####.#\n" +
            "..#...###..\n" +
            "#....##..#.\n" +
            "\n" +
            ".#.#..#.#......\n" +
            ".#.#..#.#......\n" +
            "##..##.###.#..#\n" +
            ".###.#.....#...\n" +
            "...#.#.##..#..#\n" +
            "...##....##.##.\n" +
            ".#..#....##.##.\n" +
            "\n" +
            "##..#......#..#\n" +
            "###.#..##..#.##\n" +
            "...#.##..##.#..\n" +
            "..#..######..#.\n" +
            "..#.###..###.#.\n" +
            "...###....###..\n" +
            "..###.####.###.\n" +
            "....#......#...\n" +
            "##..###..##...#\n" +
            "..##..#..#..##.\n" +
            "..##.#.##.#.##.\n" +
            "\n" +
            ".#..##.#..#\n" +
            "...#..##..#\n" +
            "..#...##..#\n" +
            "..#...##..#\n" +
            "...#..##..#\n" +
            ".#..##.#..#\n" +
            ".#..#..##..\n" +
            "###.##.##.#\n" +
            ".###.#...#.\n" +
            "###.####...\n" +
            "##.###.#.##\n" +
            "#..#.#..###\n" +
            ".#.##...#..\n" +
            "#...#.#.##.\n" +
            "...#.#....#\n" +
            "####.#..###\n" +
            ".###.#..###\n" +
            "\n" +
            "#..##.#\n" +
            "####.#.\n" +
            ".#.##.#\n" +
            "#.#....\n" +
            "#......\n" +
            ".#.##.#\n" +
            "####.#.\n" +
            "#..##.#\n" +
            "#.#.#..\n" +
            "#.#.#..\n" +
            "#..##.#\n" +
            "\n" +
            ".#..##..#.##.#.\n" +
            "...###.#..##..#\n" +
            ".##.....#....#.\n" +
            "...#...###..###\n" +
            ".##.#..#.#..#.#\n" +
            ".##.##.###..#.#\n" +
            "##.##..########\n" +
            "###....#.#..#.#\n" +
            ".#...##.######.\n" +
            "##.#..#.######.\n" +
            "#.#..##..####..\n" +
            "######..##..##.\n" +
            "#.#..####....##\n" +
            "#.##.#.#.#..#.#\n" +
            ".#...#..#.##.#.\n" +
            ".#...#..#.##.#.\n" +
            "#.##.#.#.#..#.#\n" +
            "\n" +
            "#....###.....\n" +
            ".#..###..####\n" +
            ".###...#.#..#\n" +
            "#####.....##.\n" +
            "##.##..######\n" +
            "#..##..######\n" +
            "#####.....##.\n" +
            ".###...#.#..#\n" +
            ".#..###..####\n" +
            "#....###.....\n" +
            "##.####......\n" +
            "#....##.#.##.\n" +
            "#...#..#.#..#\n" +
            ".##.#..#..##.\n" +
            "......#...##.\n" +
            "\n" +
            "##..##.....\n" +
            ".##.#...###\n" +
            ".##.#...##.\n" +
            "##..##.....\n" +
            "#####.#...#\n" +
            "##.....###.\n" +
            "..#...#...#\n" +
            "..#...#...#\n" +
            "##.....###.\n" +
            "#####.#...#\n" +
            "##..##.....\n" +
            "\n" +
            "..#...##...\n" +
            "...########\n" +
            "###..####..\n" +
            "..##..##..#\n" +
            "#..#.####.#\n" +
            "####.####.#\n" +
            "###.#.##.#.\n" +
            "....######.\n" +
            "..#........\n" +
            "\n" +
            ".....#..#.#\n" +
            ".....#..#.#\n" +
            "..#.##...##\n" +
            "....##.###.\n" +
            "#..#....#..\n" +
            "..#.#.##.#.\n" +
            "#####.....#\n" +
            "#..#..#####\n" +
            ".###.......\n" +
            ".###.......\n" +
            "##.#..#####\n" +
            "#####.....#\n" +
            "..#.#.##.#.\n" +
            "#..#....#..\n" +
            "....##.###.\n" +
            "..#.##...##\n" +
            ".....#..#.#\n";

    public static void main(String[] args) {

        String[] ss = sq.split("\n");
        int sum = 0;
        for (int i = 0; i < ss.length; i++) {
            List<String> tt = new ArrayList<>();
            while (i < ss.length && !ss[i].equals("")) {
                tt.add(ss[i]);
                i++;
            }
            for (int j = 0; j < tt.size() - 1; j++) {
                if (allRowsReflect(tt, j) == 1) {
                    sum += 100 * (j + 1);
                }
            }
            String[] uu = rotate(tt);
            for (int j = 0; j < uu.length - 1; j++) {
                if (allRowsReflect(Arrays.asList(uu), j) == 1) {
                    sum += (j + 1);
                }
            }
            System.out.println(sum);
        }
        System.out.println(sum);
    }

    private static int allRowsReflect(List<String> tt, int j) {
        int k = j + 1;
        int smudges = 0;
        while (j >= 0 && k < tt.size()) {
            smudges += stringDiff(tt.get(j), tt.get(k));
            j--;
            k++;
        }
        return smudges;
    }

    private static int stringDiff(String s, String s1) {
        int k = 0;
        for (int i = 0; i < s.length(); i++) {
            if (s.charAt(i) != s1.charAt(i)) {
                k++;
            }
        }
        return k;
    }

    private static String[] rotate(List<String> tt) {

        String[] res = new String[tt.get(0).length()];
        Arrays.fill(res, "");
        for (int i = 0; i < tt.size(); i++) {
            for (int j = 0; j < tt.get(0).length(); j++) {
                res[j] = res[j] + tt.get(i).charAt(j);
            }
        }

        return res;
    }

}
