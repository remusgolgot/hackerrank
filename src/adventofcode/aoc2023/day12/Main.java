package adventofcode.aoc2023.day12;


import java.util.ArrayList;
import java.util.List;

public class Main {

    // simple, first star, no recursion

    static String s =
            "???.### 1,1,3\n" +
                    ".??..??...?##. 1,1,3\n" +
                    "?#?#?#?#?#?#?#? 1,3,1,6\n" +
                    "????.#...#... 4,1,1\n" +
                    "????.######..#####. 1,6,5\n" +
                    "?###???????? 3,2,1";

    static String sq = "???????????#??? 5,2,1\n" +
            "#??##.??.?# 5,1,1\n" +
            ".??###?..???#?.?##?. 4,4,3\n" +
            "??..?#??#??#?.???? 5,1,1\n" +
            "?????#???? 2,1,1\n" +
            "?#?##???#????? 1,8\n" +
            "??#?.?#????.? 1,4\n" +
            "?#####??#?????.?#.. 9,2,1\n" +
            "??????#???? 1,3,1\n" +
            ".?.?#?????#?.??.? 2,2\n" +
            ".????#????... 1,6\n" +
            ".##?#???????????? 8,5\n" +
            ".?.?#?#??#??#?? 1,8,1,1\n" +
            "???#?#?????#???? 1,1,7,1,1\n" +
            "???.????.?..????? 3,1,1,3\n" +
            "???????#???.?#?#? 2,5,4\n" +
            "##?#??#?.#??????? 8,2,1\n" +
            ".??..??????????#??.# 2,1,1,6,1\n" +
            "??.????#?????? 1,1,3,1\n" +
            "?#??##?????? 5,1,1\n" +
            "?????.?##? 2,1,3\n" +
            "??.?.????.?? 1,1,1,1\n" +
            "#.#?????.?.????? 1,6,1,1,1\n" +
            "?.????????# 2,1,2\n" +
            "???#?????????#??.?? 1,3,5,1,1,1\n" +
            "??.??#.?###???? 1,3,7\n" +
            "???????.?? 1,3\n" +
            ".??#??????#??#?.?. 1,1,1,1,6,1\n" +
            "???#??.?#.???#??? 1,2,1,6\n" +
            "??#??##??? 2,5\n" +
            "#?????###???##?# 5,3,5\n" +
            "???##?.?.#?##? 5,5\n" +
            "??#????#?#??#??. 1,2,6\n" +
            "?#?????#???#?#?#???. 1,1,12,1\n" +
            "?###??????..??#?. 8,3\n" +
            "????#..??.# 4,1,1\n" +
            "##..??##???????? 2,7\n" +
            "#..??#?#?? 1,5\n" +
            "??????????###.?#.#? 1,1,7,2,1\n" +
            "..#???.?..?? 1,1,1,1\n" +
            "?#?.?.??.??#?#?#? 1,1,3,4\n" +
            "?#??#.???????.? 4,1,5,1\n" +
            ".#?????#????##??...? 1,8\n" +
            "?????#??.???.. 5,2\n" +
            "?###???.?##? 3,1,3\n" +
            "???..???????#?? 2,2,4,1\n" +
            "?#???.???? 1,1,1\n" +
            "??#?????.#??.??? 7,1,1\n" +
            "?????.??#?#?# 4,3,1\n" +
            "???#.?##???..???#? 3,4,5\n" +
            "?##?.????#???.#.? 2,2,1,1,1\n" +
            "??#???#??#????? 7,1,1\n" +
            "???.??#????.#??. 1,5,1,1\n" +
            "...?#???.?. 2,1\n" +
            "?#?#??????? 4,1,1\n" +
            "?????.?#.?. 2,1\n" +
            "?#.????#?. 1,1,2\n" +
            "????####.?.? 1,5,1\n" +
            "#??..????????#???? 1,1,6,1,3\n" +
            "?????.????#? 2,1,5\n" +
            "????????##???#?.? 11,1,1\n" +
            "??????#.??.#????.??. 3,3,2,1,2,2\n" +
            "?.?#??#??#?.????? 1,2,5,1,1\n" +
            "?.##?#.?#??????? 1,4,5,2\n" +
            "?.???????### 1,2,1,4\n" +
            "???.?#.?#???????.? 3,1,4,1\n" +
            "????.?????#?#?# 2,1,2,5\n" +
            "?????###???.?.??#.# 1,6,1,1,1,1\n" +
            "??????.??..#?#?? 1,1,2,1,5\n" +
            ".#???#???#???#??? 9,1,1,2\n" +
            "???#????#.?#??#?? 6,1,2,3\n" +
            ".?#????##??..?? 9,1\n" +
            "??#??#????? 2,2,1\n" +
            ".??..#?..?.?? 1,2,1,1\n" +
            "...??????##??.?. 3,3\n" +
            "??#?????#??.#????? 8,1,1,1\n" +
            "?????#??.. 1,3\n" +
            ".#?????????? 3,1\n" +
            "????#?##???? 7,1\n" +
            "??.?#??????#??.? 1,3,1,5\n" +
            "?????#?#?????#????# 7,6\n" +
            ".????.?????? 1,3\n" +
            "???#??##??? 5,1\n" +
            "?#???.????#?#???.??? 2,1,7,1,1\n" +
            "?????##.??????#? 4,1,3\n" +
            "??.??????#???#?.?? 2,2,1,3,2,1\n" +
            "?##?.?#???????????. 2,4,4,1\n" +
            "?#?#??#????? 1,4,1,1\n" +
            ".?????.????.??? 3,1\n" +
            "#???#.?.??.. 1,2,2\n" +
            "??#.??????. 1,2,1\n" +
            "????????????.###. 5,1,3\n" +
            ".??.#???#?? 2,2,3\n" +
            "????????????##???#? 5,6\n" +
            "??#????#?.? 2,3\n" +
            "#.???????? 1,1,1\n" +
            "?#????#?##???.?.? 1,6,2,1,1\n" +
            "??????????#??? 4,4,1\n" +
            "?##??...???##?????. 4,7\n" +
            "#??##??????.#???.??# 5,1,1,1,3\n" +
            "?.?..?##?????.# 1,1,8,1\n" +
            "?.?.#??#?. 1,2,1\n" +
            "?.???.#??? 2,3\n" +
            "..?????????#? 1,4,1\n" +
            "??????????#????.? 2,6,1\n" +
            ".?????#????.?.????. 1,5,1,3\n" +
            "??????.?#?? 6,2\n" +
            "####???????#?.? 4,2,1,1\n" +
            "?#?##?????.... 1,7\n" +
            ".?.??#??.?#???.???? 1,1,1,1,1,4\n" +
            "??.#.?????#?? 2,1,2,4\n" +
            "???#?#?????#???## 1,3,1,7\n" +
            "#????.??##?????. 5,4\n" +
            "??#.?#???##?????# 1,7,4\n" +
            ".??.??.#????.???#.? 2,1,2,1,1,1\n" +
            ".?###???????.??##..? 7,3,1,2,1\n" +
            "..???#???##? 1,7\n" +
            "??.?.???##?#??.##.? 1,1,7,2\n" +
            "???.?.???.?.? 1,1,3\n" +
            "????#???#.#???#### 8,1,6\n" +
            "?...##??.????#?#??#? 4,6\n" +
            "#???#.#???###???? 3,1,8,1\n" +
            "#???##?#??.?#??. 1,5,1,1\n" +
            "????#?.###?????. 1,2,3,4\n" +
            "??#?###??.???.?#? 7,1,3,1\n" +
            "#?.??#?????#??.????? 2,9,2,1\n" +
            "?????###?##.?????.. 6,4\n" +
            "#?..??#??????#???? 2,4,3,2\n" +
            "???##?##???#????? 1,2,11\n" +
            "????.?.#?#??????? 2,1,3,1,1\n" +
            "??????#?.???? 1,2,2,1\n" +
            "#.???????##.??#? 1,2,3,2\n" +
            "?.?????#.?##..????# 1,2,1,2,1,3\n" +
            "#??.#?#?.? 1,4\n" +
            "?????????##? 3,1,3\n" +
            "#.?.?#??#??#.?#??? 1,1,7,1,1\n" +
            ".?..#?.????#???#???? 1,9\n" +
            "?#?#?.??????#????? 2,2,1,3,1,1\n" +
            ".??.???#?????#?? 1,1,5,3\n" +
            "?#.?#???.. 1,3\n" +
            "?.?..??????? 1,1,1,4\n" +
            "????????#?. 3,1,2\n" +
            "??.#???.#???????#?. 1,1,1,3,2,2\n" +
            "??#???##??.?? 1,1,5,1\n" +
            "??????.??????? 5,5\n" +
            "#?#??..?????.??#??#. 5,3,5\n" +
            "???????#.????.##. 1,3,1,1,2\n" +
            ".???#...#? 4,1\n" +
            "##???????????? 3,2,1,2\n" +
            "????????#??# 1,1,4\n" +
            "#??????????.??#.?# 7,1,1,1,1,1\n" +
            "#?...????.??###?? 1,3,6\n" +
            "??????##.????? 3,2,2\n" +
            ".#?..????##?.??????? 2,1,4,1,5\n" +
            "?????.????# 3,1,2\n" +
            "????##???????? 4,3\n" +
            "?.?????#?.? 1,4\n" +
            "??#.?.?.??#??#??...? 1,6\n" +
            "??#???#??? 4,1,1\n" +
            "??#????.?#.??#???.? 5,1,1,3,1\n" +
            "??#?#.##?#???. 2,1,7\n" +
            ".??#????#????#?? 2,6\n" +
            "???.???.???. 2,1,1,1\n" +
            "?#????#???? 2,1\n" +
            "#???.#?##?.?##..?? 1,1,1,2,2,1\n" +
            "#?.#.?#.???.??. 1,1,2,1,1\n" +
            "??.???#???????? 1,9\n" +
            ".?.??.???#??#?? 1,1,8\n" +
            "???????????? 3,5,1\n" +
            "#####????#?.??. 11,1\n" +
            ".?#???.?#. 2,1,1\n" +
            "????.???????#??????? 5,1\n" +
            "???#..?#???? 1,1,1,2\n" +
            "????##??????#??#???# 2,12,1\n" +
            "?#.???#?#??#??#. 1,7,1,2\n" +
            "#?#?#?.???? 5,3\n" +
            "?#...?????? 1,1\n" +
            "??#?.#??##? 3,1,2\n" +
            ".#???#??.?.?????? 7,4\n" +
            "?#???.???#.?????.??# 4,1,1,1,1,2\n" +
            "???.?????###??#?? 2,1,9\n" +
            "#???????#?###. 2,8\n" +
            "???#?#????#?#??#. 6,2,1,1\n" +
            "??#?.????#?????.? 1,1,1,7,1\n" +
            "#???#???#????###?#?. 3,1,6,5\n" +
            "#.???#????#??.##???# 1,2,6,3,1\n" +
            "???????#.?#? 8,1\n" +
            "????.?#?#.??????. 2,4,5\n" +
            "??.?#?#??????#?#??? 4,5\n" +
            ".?#??###?#?.????? 9,1\n" +
            "#?#??.#?????#??##??? 1,3,1,1,1,4\n" +
            ".??.???##??#? 1,4,1\n" +
            "???#.?##??#? 1,6\n" +
            "?????##?.?..#?#???? 1,1,2,1,1,4\n" +
            "??.#????.# 1,1,1\n" +
            "????????#. 2,1,1\n" +
            ".??.???#??#? 2,1,1,2\n" +
            "#..???#??#???? 1,1,7\n" +
            "?.??.?#.#? 1,1,1\n" +
            "??#.????..?????###?? 3,4,1,2,4\n" +
            "?.??.?#?.??#???.. 2,4\n" +
            "??##??????..#???? 5,1,4\n" +
            "??????..#???#??#??? 1,3,1,7\n" +
            ".??.???##??.#. 2,3,1\n" +
            ".#???.#??#???#?#??# 1,2,5,2,1,1\n" +
            "??#?#.?#?? 4,1\n" +
            "???##?..?#?????..? 4,6\n" +
            "??.??.??????? 1,1,1,3\n" +
            ".?????????.???. 6,1,1,1\n" +
            ".??#?#?.???#. 4,1,1\n" +
            "????#??.?.??????? 5,4\n" +
            "..#.#????.???? 1,4,2\n" +
            ".?##.?#.??. 2,2\n" +
            "???.#?#?###????.??#? 1,8,2,3\n" +
            "????...??#?#???? 1,6\n" +
            "?????##?#???? 1,6,1\n" +
            "??.??#??#??#?#?????? 1,3,1,8,1\n" +
            "????#????#????? 8,1\n" +
            "????#?#?#.?? 1,6,1\n" +
            ".?#????##?????????? 2,1,10\n" +
            "?#.????#..?? 1,2,2\n" +
            ".????.???#?#??? 2,5\n" +
            "????#..#?? 2,2,1\n" +
            "???#???.?##???#? 4,8\n" +
            "???????..??.?? 4,1,2,1\n" +
            "??.?#?????? 2,1\n" +
            ".???.????#??.?? 3,4\n" +
            ".#.???.??? 1,2\n" +
            "??#???????????.#.??? 1,1,5,1,1,2\n" +
            "##???##..?????#????? 2,3,2,1\n" +
            "?#.?????#??? 1,2,4\n" +
            "#?#????..??? 1,5,2\n" +
            ".??#?.???#??????? 4,1,6\n" +
            ".?#????.?#.?.? 4,1,1,1\n" +
            ".???.??????? 1,2,4\n" +
            "..????#?????#???. 2,4,5\n" +
            "#?#?#?.?.???#? 5,1,1,1\n" +
            "??????##?##????? 1,1,6,1\n" +
            "?##???????????.?. 4,1,1,1,1\n" +
            "???#?..?.??? 1,1,1,2\n" +
            "??#?????#???.?#? 4,6,3\n" +
            "????????????.#? 5,1,1,1\n" +
            "?.??.??#?..?.#?.?? 1,2\n" +
            "#..#???????#??? 1,7,1\n" +
            "???????.?.????# 5,1,1,1,1\n" +
            "??.??.??#?. 2,1,3\n" +
            ".???.??#?##??.#.?# 3,6,1,1,2\n" +
            ".???..???? 1,2\n" +
            "..???##??#??.??..?.. 8,2\n" +
            "?#.#?.#?##??. 1,2,1,2\n" +
            "???.????..? 2,2\n" +
            "?###.?...?.????? 3,1,1,1,2\n" +
            "?????#.??????.??#? 1,3,1,1,1,1\n" +
            "##?#??.#?#.??. 5,3,1\n" +
            ".?.#?#??????##? 1,3,1,2\n" +
            "?####?.????. 5,1,1\n" +
            "???##.??..?#???#???? 5,2,9\n" +
            "?#??.?##???#????? 2,12\n" +
            "#?#????#??..##?? 3,1,3,2\n" +
            "???#???##?#?.???? 1,1,4,3\n" +
            "???.??.?##???.??? 1,5\n" +
            "???#?..#?#???#.???? 4,7,4\n" +
            "????#???????????#? 12,1,2\n" +
            ".#?#.??#.?## 1,1,3,2\n" +
            ".?????#???????#? 3,1,7\n" +
            "#??#?????#?????? 13,1\n" +
            "?##??.?#.????.#?? 5,1,2,1,1\n" +
            ".??#??.???#????. 3,5\n" +
            "?#?#??#.#??.??. 3,2,1,1,1\n" +
            "#??????..???#??? 1,2,2,3,1\n" +
            ".?.???...??? 2,1\n" +
            ".????#?.#?#???#???## 2,12\n" +
            ".??#???#?#.??#?#???? 1,1,5,1,6\n" +
            "?????#.?????#???? 5,6\n" +
            "????.??.?? 2,1\n" +
            ".??#?????#??????? 1,1,1,5,2\n" +
            "???#.?#..? 3,1\n" +
            "??#????#?#?##?##?.? 5,10\n" +
            "?????.??#?##.??? 5,6,1\n" +
            "?#???.???? 3,1\n" +
            "??.#??##?##???????# 1,14\n" +
            "#.???????#???.?.#. 1,1,2,2,1,1\n" +
            "#?#???#????#??#?#?? 8,3,2,1\n" +
            "#.??#??#????????? 1,7,2,3\n" +
            "?.#.???#???#?# 1,9\n" +
            "####????????.# 6,4,1\n" +
            "?#?#?#??.? 6,1\n" +
            "#??.?#?????#?#??? 3,5,1,2,1\n" +
            "?#??????#???.? 10,1\n" +
            ".??.##.???#?????. 2,8\n" +
            ".???#????.?.#??? 2,2\n" +
            "???.?#?#???#????? 2,8,3\n" +
            "??.?..?#?..??##?.??? 1,4\n" +
            "????#????#??? 1,7\n" +
            ".????#????#???#?#? 2,2,2,2,1,1\n" +
            "????#?#?#.?.??????? 1,5,1,1,1,1\n" +
            "?#??#??..##???#??# 1,2,1,2,1,4\n" +
            "?.???##?#????##??. 1,4,1,4\n" +
            "???#???#?###?..?#... 11,2\n" +
            "#?#.?.?.#?..? 1,1,1,1\n" +
            "###?.?.?.???#???#.? 3,8\n" +
            "#.???#?????#?? 1,10\n" +
            ".?#?????.?#.??? 6,1,2\n" +
            "?.#?.????.? 2,4,1\n" +
            "#?.??#???#? 2,1,3\n" +
            "?.#.??????.??#??# 1,1,1,3,6\n" +
            "?##??????##.?????### 3,7,1,1,3\n" +
            "??##?#?#???.?###???? 8,6\n" +
            "?#?.???.??#???# 2,1,6\n" +
            "????#??.???# 2,1\n" +
            "#??.???.??? 1,2,1\n" +
            ".???##???? 1,7\n" +
            "#???.#??.#.? 2,1,1,1\n" +
            "??????????# 3,1,2\n" +
            "#?#?.??.??.?? 3,1,1,2\n" +
            "???#??.##???..?#?? 4,4,3\n" +
            "??#???.???#? 1,1,3\n" +
            "???#??????# 3,4\n" +
            "?#..??????? 2,2,3\n" +
            "?#?#.??..?????. 4,1,1,2\n" +
            "???????###??? 1,1,4\n" +
            ".????#.??????.?????? 5,2,3,2,1\n" +
            "???#???#.? 3,3,1\n" +
            "?..??#?##? 1,1,5\n" +
            "?.??..?????. 1,2,2,1\n" +
            "???.??..##?#? 1,1,2,1\n" +
            "????????#??. 2,1,2\n" +
            "????###???????#?? 7,4\n" +
            "????#????#?#??.#??? 1,5,4,1,1\n" +
            "??#?.???#?#?##? 4,1,7\n" +
            "???.??#??#????###? 1,1,5,3\n" +
            "????.???????. 2,5\n" +
            ".#??????#??#..??? 3,1,4,2\n" +
            "?.??#?????#? 1,4,3\n" +
            "????.#???#??? 1,1,1,5\n" +
            "?.#??????????? 1,3,1,1\n" +
            "????..???#?.??#????? 1,2,5,3,2,1\n" +
            "??###????#???.??.?#? 13,1,1\n" +
            "?????.?.?? 5,1\n" +
            "#??#??##????.# 1,1,7,1\n" +
            "?##????????#?.?? 8,2,2\n" +
            "?#??#???#?????..?? 5,6\n" +
            "..??..?.??? 1,2\n" +
            "???.??????.??##??. 3,1,1,5\n" +
            ".???#??.?.?????##??. 1,2,1,1,6\n" +
            "??#?#.??????#??. 5,1,5\n" +
            "???#???##???.#?? 11,1\n" +
            "#?#????????.????.?? 11,1,1,2\n" +
            "??#?.???#?????????? 4,11\n" +
            ".??.?????. 1,5\n" +
            "##??##?#.??.? 8,2\n" +
            "???#??##?#?###??## 12,2\n" +
            "?##???.????##?#?? 3,1,7\n" +
            "??#????#?#?.# 4,2,1,1\n" +
            "?#??????#???????? 12,1\n" +
            "?..??#????#??????##. 1,10,5\n" +
            "??.??????#??.. 1,4\n" +
            "?????.#??? 3,2\n" +
            "???#???##???? 1,8,1\n" +
            "??.?????.??????????? 3,1\n" +
            "?#??#?##?###?????## 11,2\n" +
            "?.???????????? 6,2\n" +
            "???.?.???#???#.?? 1,7,2\n" +
            "???#??#???#?????? 3,2,2,2\n" +
            "..?#####????# 9,1\n" +
            "?#??????.?? 1,2,1\n" +
            "#?#???#??#. 7,1\n" +
            "..#??##?#????#???##? 2,11,3\n" +
            "?#????????.???#??? 3,1,2,4\n" +
            "?#?.??.#????.. 2,2,5\n" +
            "?#.?#??????##.??#?? 1,1,7,4\n" +
            "???##??###??..#? 1,2,6,2\n" +
            "?#????#?????. 7,1\n" +
            "#?????##?#? 2,2,4\n" +
            "#?.??#??..#??#?#?? 1,4,1,1,1,1\n" +
            "#??????..??##?.? 6,1,3,1\n" +
            "???#???.#??#?? 4,2,1\n" +
            "?..??#?????? 4,2\n" +
            "???????#???.#??#???? 3,4,1,1,2\n" +
            "##???#?#?.??????. 3,3,4\n" +
            "?##?.#..?#??#??#? 2,1,1,1,1\n" +
            "?#???????#?? 2,5\n" +
            "????#?????. 5,1\n" +
            "?.??.#???#???? 2,8\n" +
            "??#.?????#???###???? 1,1,1,1,1,9\n" +
            "?#?????#.#????.?..?? 1,4,4,1,1\n" +
            ".???.##????????. 2,1\n" +
            "#.?#??#????#??? 1,1,10\n" +
            "????.?.#.#??##?#??? 1,1,1,1,1,7\n" +
            "???#????##?.?? 8,1\n" +
            "?.#??.??????###.??.? 1,2,2,5,1,1\n" +
            "??#??.#?.. 1,1\n" +
            "??????????????#?? 1,5,5\n" +
            "????##??.?#.??? 1,3,1,1,3\n" +
            "?????##??.#????#?.? 7,1,1,2,1\n" +
            "#??.?#???. 1,1,3\n" +
            ".?#??????#??.#?#?? 2,1,5,1,1\n" +
            "???##.??.????#?. 5,2\n" +
            "???????#?#?#????# 1,7,1,4\n" +
            "?..?#...?.? 2,1,1\n" +
            "????????#??? 1,2,2\n" +
            ".?#?????#???.#?.?.?# 11,2,1,1\n" +
            "?.?.??#??????????. 6,1\n" +
            "??.?????##??# 1,3,2,2\n" +
            "??##.###?#?#?#?. 1,2,9\n" +
            "????.##?????? 2,2,2\n" +
            ".?#??##??# 6,1\n" +
            "?#????#????? 2,1,1,4\n" +
            ".???#?#???.#??# 3,3,4\n" +
            "???#?????#.?? 1,2,5,1\n" +
            "????##??#???#. 8,1\n" +
            "?#??????..?.???? 3,2,1\n" +
            "???????#????##??? 3,4,5\n" +
            "??.##.???? 2,1,1\n" +
            "??..#??..???# 2,2,1,1\n" +
            "?#??.?#?#??????? 3,2,2,1\n" +
            "##?#??????###?#.???. 15,1\n" +
            "??.???????#?.? 3,3,1\n" +
            "?##????.?.? 3,2,1\n" +
            "???.????###??# 2,7,1\n" +
            "#????#?#??#?###????? 1,2,13\n" +
            "????????????.#????. 1,8,1,1,1,1\n" +
            "#?????#??#????? 4,1,2,1,2\n" +
            "??????????#.??.?.#? 1,7,1,1,1,1\n" +
            "?.??#??????#??#??# 1,1,3,1,1,2\n" +
            "??.??##?..?#???. 1,4,1,2\n" +
            "?.?#..???.?# 1,1,1,1\n" +
            "???.#??#??????. 2,2,2,2\n" +
            ".??#?????#?#??????.? 3,8,1\n" +
            "??#??#?#??#????.#??? 11,1,3\n" +
            "????#??????? 1,3,1\n" +
            "?##???#???.???? 2,6\n" +
            "?#?#?#?????. 5,1\n" +
            "#?..????.. 1,1,1\n" +
            "????##?????#??? 1,5,1,1,1\n" +
            ".?###??????#??????? 12,2\n" +
            ".????..??#.? 1,2\n" +
            "???##..#????. 1,3,1,2\n" +
            "##?#?#?##.??? 6,2,1\n" +
            "?.?.??.?.##??????.? 1,1,4,1,1\n" +
            "??#??.#???..?????? 2,4,6\n" +
            "?#???.???.??? 4,2\n" +
            ".??.???.#####??? 3,7\n" +
            "????.?????#?????. 1,2,4,2,1\n" +
            "?????##?#??#? 1,10\n" +
            ".?.?###???#???#?? 4,1,1\n" +
            ".#?.????#???.?#. 1,8,1\n" +
            "?###?#?????.?.?#?. 9,1,3\n" +
            "?.?##.??#.??.?.##??. 1,3,2,1,4\n" +
            "??????.??? 2,2,1\n" +
            "????.????????#?#??#? 2,1,2,9\n" +
            "?????#???????? 6,2\n" +
            "?#.?#??..?. 1,3,1\n" +
            "????#???.#.???. 2,1,1,1,1\n" +
            "##?..??.??#..??????? 3,2,4\n" +
            ".????###???.?.??? 8,1,1\n" +
            "????.?.??. 4,2\n" +
            ".??#.?????##?.?#.?#? 3,7,2,2\n" +
            "?#????.????# 1,1,1,2\n" +
            "??#??####?##???.?? 1,11,1\n" +
            "???#??#???#???.??? 1,9,1,1,1\n" +
            "?#???#???.??# 2,2,2,1\n" +
            "?????.???#??? 3,7\n" +
            "?..#?.??#.?????? 1,1,1,1,6\n" +
            "????#...#...?.? 4,1,1,1\n" +
            ".?#???..????? 3,1,1\n" +
            "??###??#???????##?# 5,12\n" +
            "?#?????#?? 4,1,1\n" +
            "??????????.?#? 1,1,2,2\n" +
            "#.???????????.?#?.? 1,6,2,1,1\n" +
            "???.?#???#??##???##? 1,4,2,4,3\n" +
            "????....?#?###. 3,6\n" +
            "?????.?.#??? 1,1,1,2\n" +
            "?#??..##?#?#??.???? 1,1,4,2,2,1\n" +
            "??#????##???? 7,3\n" +
            "..????.????. 2,2\n" +
            "???.???.##?#?#?#? 1,1,9\n" +
            ".???.??.?. 1,1,1\n" +
            ".####???????#.??. 7,2,1\n" +
            "#?#?##??.?#??.?#?? 1,1,2,3,2\n" +
            "##?##???#??.???? 6,2,2\n" +
            "?.###???????#? 6,2\n" +
            "??????#..?...????. 4,1,1,1,1\n" +
            "?..??##????#?. 1,4,2\n" +
            "???#??????#?. 5,1,1\n" +
            "????????#????? 1,1,4,2\n" +
            "???.???.?#?? 1,2,1\n" +
            "????#.??#? 1,1,2\n" +
            ".??#??##??#????.? 9,1\n" +
            "??.?..?#?????## 1,1,9\n" +
            "??#???..???????. 4,5\n" +
            "#..?.#????.???#?.??? 1,1,5,4,1\n" +
            "?.#?.?#??##?#..??? 2,7,1\n" +
            ".?????.?#?##??? 1,7\n" +
            "???????#??.?#?? 3,2,4\n" +
            ".???#??#??????#? 9,1\n" +
            "???#??.????. 1,2,1,1\n" +
            "??.?.?#?.????#???? 2,1,8\n" +
            "??#????#.?##?????? 1,3,1,3,2,2\n" +
            "????#???#???? 2,2,3,2\n" +
            "#.????.#??????. 1,1,1,6\n" +
            "?#???..??#?#?.? 3,1,1,1,1\n" +
            "??.??#?#??? 1,6\n" +
            "???.#????##???? 2,4,1\n" +
            ".???????#?# 4,1,1\n" +
            "#???##..???#?#? 1,4,1,1,2\n" +
            "#??#??#?.???????.#? 1,5,2,1,2,2\n" +
            "..?.?#????#???##???? 1,13,1\n" +
            "?#??#???###??? 3,3,5\n" +
            ".??##????## 5,2\n" +
            "???.?.???#???.# 1,1,4,1\n" +
            "??.?????.????#?.??? 1,1,2,6,2\n" +
            "##??.#?#?? 3,5\n" +
            ".??????.?#??. 1,2\n" +
            "?????.?..#?#? 3,4\n" +
            ".??.???#??? 1,3\n" +
            "??#????#??????# 1,8,1,1\n" +
            "??.??#?.?????##???#? 4,3,6\n" +
            "?.#?#?#?#.????#??#?? 7,4\n" +
            "??????????#?. 3,3,1\n" +
            "????#?.??#?? 5,3\n" +
            "#???????.?.#?# 1,4,1,3\n" +
            "#.??#.#??.??.?#.?. 1,3,2,1,2,1\n" +
            "???#?.???#? 3,1,2\n" +
            "????#.???#???##?#??? 1,1,5,7\n" +
            "?#??##?.???#?#?.#? 1,2,6,1\n" +
            "?##?????##??? 3,3\n" +
            "??????????#??? 4,2\n" +
            "????.???##? 3,1,4\n" +
            ".????#?.??.??.??? 1,2\n" +
            "?..##?#??????????? 5,5\n" +
            "????????.?#?? 5,2\n" +
            "?###???????????.? 9,1\n" +
            "?#.?#??#..????. 1,2,1,3\n" +
            "??.#???.?????..???? 1,1,1,4,1,1\n" +
            "#?#?#?.???##???? 1,3,2,3,1\n" +
            "??.?.?#???#????#??? 2,1,3,1,5\n" +
            "?#??#?.#??????#. 4,2,1,1\n" +
            "??#???#??? 2,4\n" +
            "#??#?##?????#?? 2,1,2,1,2\n" +
            "#?##.?#???#??? 4,1,1,1\n" +
            ".???##.##.# 5,2,1\n" +
            "#???.#???????### 1,1,1,9\n" +
            "??##??????. 4,2\n" +
            "?#??#????.?.?? 4,3,1,2\n" +
            "?.#?#????.#???????# 1,6,1,3,2\n" +
            "?????.#??? 4,1\n" +
            ".????#?##?#??? 1,8\n" +
            "??#??.#.????? 2,1,1,1\n" +
            ".???.???..? 1,2,1\n" +
            "?#?#?.???# 5,1\n" +
            "???.#?.????.#? 1,2,2,1\n" +
            ".#.????#????#.???? 1,6\n" +
            "?.#?#?##.?.??? 6,1\n" +
            "???#?..##?#?.?? 3,5\n" +
            "#???##?##??#.??.#..# 12,1,1,1\n" +
            "?#?#?#???#?#?? 6,4\n" +
            "#??.???###? 1,6\n" +
            "????.#.#???######?. 1,1,2,7\n" +
            "??#.?#?#??#???. 1,8\n" +
            "?????????.???..??. 1,7,1,1\n" +
            ".??#?#????#???? 1,1,3,1,2\n" +
            "#??.?#????##???#?#? 3,1,1,9\n" +
            "?.????#???????????. 3,1,5,2\n" +
            "??.?#????.#??? 1,1,3,1\n" +
            "?.???????.?. 6,1\n" +
            "#?#??#.??#?#??## 1,4,7\n" +
            ".?.?###???..?#? 5,2\n" +
            "???#??#??#?#?###??? 5,8\n" +
            "?????.??.?. 4,1\n" +
            ".?.???#?##????? 1,4,2\n" +
            "????????.??.????..? 6,1,4\n" +
            "????.?#?#? 1,3\n" +
            "??#??.#??????#? 1,1,3,1,1\n" +
            "#?.?????.?.#?##?. 2,1,1,4\n" +
            "?#??#??????# 2,2,3,1\n" +
            "?#?#?????..??#?#?#? 2,1,1,1,8\n" +
            "?##?.?#?####? 4,7\n" +
            "#?????.#??.? 1,2,3,1\n" +
            "?#??????..?? 1,4,1\n" +
            ".##???##?#?.?? 10,1\n" +
            "????##?????.???.?.# 1,7,1,1,1,1\n" +
            "?#??????#??? 2,2,2\n" +
            "?#???.??.????.#?? 3,1,1,1,2\n" +
            ".?.???..##?##??#?#? 1,1,6,3\n" +
            "?????#?.??#. 1,4,1,1\n" +
            "?.?.#?.#?#????##.??. 1,1,2,9,1\n" +
            "???.?##???..#.?? 1,4,1,1,1\n" +
            "?????#????#?#???. 1,10\n" +
            ".??????#???. 8,1\n" +
            "??????#?#?#.?. 9,1,1\n" +
            "#?.??????..? 1,1,3,1\n" +
            "?#??.??.?.?. 1,1,1,1\n" +
            "??????#??.???.?? 5,3,1,2\n" +
            "#????#?.####??#?#? 1,1,1,9\n" +
            "..??#???#..# 1,2,1,1\n" +
            "????????.?.?.??.???? 8,1,1,1,4\n" +
            "???.??.???.???? 1,1,3,4\n" +
            "?#??.?????# 1,2\n" +
            "?#????#??????????? 2,4,1,1,1\n" +
            "???.#?##?#?????? 1,9\n" +
            "#.???#?????.?#???.? 1,6,1,2,1\n" +
            "?#..????????? 2,1,2,3\n" +
            "???#.???##.??.?. 2,3\n" +
            "??#?????????? 5,1,1\n" +
            "?#????.#???? 4,1,1,1\n" +
            "??..?#?##????????. 1,7,1\n" +
            "?????#..??..# 4,1,1\n" +
            "??..#?????.??#?????? 2,4,1,3,1,3\n" +
            "???????????????#?.?# 1,4,5,2\n" +
            "#?.?????.#??????? 2,4,1,5\n" +
            ".?.???#??..??????#?? 1,4,1,6\n" +
            "??#?#?.#??# 3,1,2\n" +
            "#?#??????????##? 1,1,6,4\n" +
            "?.???????? 1,2\n" +
            ".??#??.????? 1,3,1,3\n" +
            ".?#?##?.#?.??#?? 2,2,2,2,1\n" +
            "?#???????? 1,2\n" +
            "???#?#.#??#???????? 1,1,1,3,2,1\n" +
            ".??..????? 1,1,1\n" +
            "???.????.? 1,3,1\n" +
            "?????#?????????#? 6,1,2\n" +
            ".?.#??.?.?..?#?###?? 1,6\n" +
            "#?#??#?.???# 4,1,1,1\n" +
            "?#????#.??. 1,3,1\n" +
            "????.??#..????????? 2,1,3,2,4\n" +
            "?#?..????##.. 2,5\n" +
            "??.##..?.?#? 1,2,1,1\n" +
            "???#####??.??.?????? 9,5\n" +
            "??#??#??#??????.???? 2,8,1,1,1\n" +
            "??????????#???.? 6,4\n" +
            "?.?#??.#.??#??##.?#? 1,1,1,1,7,3\n" +
            "??..#?.??? 1,1,2\n" +
            "??#?#?#?#??#. 9,1\n" +
            "?##??##???????#??? 8,3,1\n" +
            "#??#??.?#.? 1,3,1\n" +
            "?????#?..????#?#? 4,2,2,1,1\n" +
            "?.??.?#??? 1,1,1\n" +
            "??#??..#?..? 1,1,1,1\n" +
            ".????.????#???? 1,6\n" +
            "??#????##??.??#?.? 9,3\n" +
            "??#???.#??????#??.? 2,2,1,1,5,1\n" +
            "?#??#?###?.?.??? 9,1,2\n" +
            "?????????? 4,3\n" +
            "#?????????.??.?? 1,1,1,3,1\n" +
            ".??????..?? 4,1\n" +
            "????.????.?.?# 2,3,2\n" +
            "??..?.?.?#? 2,1,1\n" +
            "??#?????#?. 1,3\n" +
            "???#??#??.?. 2,5\n" +
            ".??#?###??#.?#. 9,1\n" +
            "???.???#?.? 1,4\n" +
            "?????#.?.?#?. 2,1,2\n" +
            "?#?.??##.. 3,2\n" +
            "?#????#?.#?.?. 3,4,1,1\n" +
            ".?#.?##.??#? 2,3,1,1\n" +
            "..?#?????? 6,1\n" +
            "???...??#?..??? 1,1,1,2,1\n" +
            "????#?????????# 1,2,1,1,4\n" +
            "???#???#??##??? 4,2,3,1\n" +
            "??#?#???##???# 1,4,4,1\n" +
            ".?????#?#. 1,1,1\n" +
            "#.??????#???..??.??? 1,1,5,1,2,2\n" +
            "?.??.???..?## 1,1,3,3\n" +
            "?..??#????##.??? 1,1,2,3,2\n" +
            "??.?#.?.#.. 2,1,1\n" +
            "????.??????.#.#?# 1,3,1,1,3\n" +
            "?????#??##..?#. 2,3,2,1\n" +
            "?.??##?.??#?#???? 2,6\n" +
            "#?????#.#??##?.# 1,2,1,6,1\n" +
            "?#.??###??.????? 1,5,1,4\n" +
            "##?????#???????.?. 9,1,1,1,1\n" +
            "??????#???#??#?? 1,1,1,5\n" +
            "???#.?#??????##? 2,2,1,3\n" +
            "???.?.#????#???..??? 2,8\n" +
            ".?.?#.????#??##???? 2,11\n" +
            "#???#??#??????##?#?# 2,2,5,2,3\n" +
            "???.#????..?? 1,5,1\n" +
            "??#?.#??##??.?????? 3,6,4\n" +
            ".????.#?#??##??? 2,10\n" +
            "??.#?..?????????# 1,1,2,1,4\n" +
            "?.???#?..??.??#?? 1,3,1,2\n" +
            "#??#???.????##?#?. 7,6\n" +
            "?#.??#?.?#.????#.?# 1,3,1,4,1\n" +
            "???????##??##??##?? 2,6,3,3\n" +
            "#????????????##?.. 9,4\n" +
            "?#..?##?.???? 1,3,4\n" +
            ".?.#??.??.? 2,1\n" +
            ".???#????. 1,2,1\n" +
            "??????#???#.?. 1,6,1\n" +
            ".????#??????#??#..? 2,4,1,2,1,1\n" +
            "?#?..#?.???#????? 2,2,7\n" +
            "??.?#?##.#.?#????? 1,4,1,3,1,1\n" +
            "?.????#???. 1,4,1\n" +
            ".???.?????? 1,2,1\n" +
            "????.?#??##???? 3,8\n" +
            ".?.##?.??#.?# 2,3,1\n" +
            ".?#??#?##???#.?? 1,8,1\n" +
            "?##?????#???? 3,1,4,1\n" +
            "???????????#.???#### 1,1,4,7\n" +
            "??#?..?#???#?? 3,2,2\n" +
            "?##?.??#.??.?.?? 3,3,1,1\n" +
            "?????##?###.??#? 3,6,1\n" +
            "?#???#??#????? 8,1,1\n" +
            "???.#??###??#?##?#? 1,7,1,2,1\n" +
            "#?#????.#?????? 5,1,1,1,2\n" +
            "????##?###??#. 1,1,6,2\n" +
            "?.#??#?#?#???. 2,5,1\n" +
            "#????#?#????? 2,4,1\n" +
            "#?#?????##??.???. 11,2\n" +
            "????#??.??? 4,1\n" +
            ".??.?.???# 2,1,1\n" +
            "??.#?.#..???.?. 1,1,1,2,1\n" +
            "???????#??. 7,1\n" +
            "????#??##? 5,2\n" +
            "#??.?#?.?#?#??#?? 3,2,9\n" +
            "?###????#?#?#??.??. 15,1\n" +
            "?.##?????????#??#? 6,4\n" +
            "????.?#.?#?#? 2,1,5\n" +
            "?#?..?#?## 3,2,2\n" +
            "?#??????#??.??#?. 2,3,1,1,1\n" +
            "????.????#??. 1,1,4\n" +
            "#.??##????? 1,8\n" +
            "??#??#?.????#?# 6,1,5\n" +
            "????#..???#?? 4,5\n" +
            "???????#?###?? 1,1,6\n" +
            ".??????..###? 1,1,1,3\n" +
            "???????#?.#??##??##? 1,1,2,9\n" +
            ".????????##?#???#??? 2,2,11\n" +
            ".#?.##?##????.??#.? 1,9,1\n" +
            ".?.???#?#??####????# 1,1,11,2\n" +
            "???????..? 1,2,1\n" +
            "??.??#???? 2,2,1\n" +
            "?????#?.??? 3,2,1\n" +
            "????#?.##???#?.???? 4,7,2\n" +
            "#?.???????#??.#?? 1,4,3,1\n" +
            ".?#?#?##?#????????. 4,12\n" +
            "???#?#?#?##?..???? 10,1,1\n" +
            "?????.??#?.??.?.?? 1,1,4,1,1,1\n" +
            ".#?.????.?? 1,1,2\n" +
            "?????#??????#? 7,2\n" +
            "???.?.?????.??..?.. 2,1\n" +
            "?#?#.?????####????? 3,11\n" +
            "???????#???#? 2,1,2,1\n" +
            "??#?.?.?#?? 3,3\n" +
            "####???.?? 4,1,1\n" +
            "??????.##?. 1,2\n" +
            "????##.?#?.. 1,3,2\n" +
            "??#???#?#?#.??#? 10,2\n" +
            "??????#???????.?#??? 1,3,4,2,1\n" +
            "??????#?##????#??.?? 1,10,1\n" +
            "#????#??????# 6,1,1,1\n" +
            "??????#??##???#?. 7,3,2\n" +
            "??.?#.#?#?. 2,1,4\n" +
            ".?#..???#?.? 2,1,2\n" +
            ".#?#?##?.?#?. 1,4,1\n" +
            ".?.?..#.#? 1,2\n" +
            "??..??.?????#?#? 2,2,1,1,1\n" +
            "?????????.???#???? 2,5\n" +
            "????.#????#?????.??? 1,1,1,9,1,1\n" +
            ".??##???????? 5,2,1\n" +
            "??#?#?.?.??#???#? 5,1,2,3\n" +
            ".??#?????..? 5,1\n" +
            "??#????..??????#?.? 7,3,2\n" +
            "??????.?#??# 4,5\n" +
            "?#??.????#?? 2,4\n" +
            "?.??#?##??.??? 8,1\n" +
            "#??###????#??.?? 7,1,3,1\n" +
            "??#?.????.#?#????? 2,1,1,5,1\n" +
            "??#?##?.#?.?.#?#??? 5,2,4\n" +
            "..????????.? 2,3\n" +
            "#????#???.?#?#?? 6,1,2,1,1\n" +
            "??.??#????#?? 1,4,3\n" +
            "???#?#?.?.#?? 1,4,2\n" +
            "??.??.??#?? 2,1,2\n" +
            ".???.?.?#?#??# 1,7\n" +
            "?...#????.?#?. 5,2\n" +
            "??##?#?#?? 3,3,1\n" +
            "??.?.##??#?#??.?? 1,8,1\n" +
            "#?????.?????#?? 1,1,8\n" +
            "????#.#.##?? 2,1,1,4\n" +
            "?.???..??. 1,1,2\n" +
            "??#???#?#????#???#.# 2,10,1,1\n" +
            "????????#????#?? 1,1,4,3\n" +
            ".?#?.???#? 1,1,1\n" +
            "????#????????.#?.# 1,6,2,1,1,1\n" +
            "?#..??????.???????# 2,1,2,7\n" +
            "??#.???#???????. 3,1,2,3,1\n" +
            "??#?#.?????..???? 5,1,2,1,1\n" +
            "???????????.#.#?.?. 2,4,1,1,2,1\n" +
            "??..#?####??#.????.? 9,2\n" +
            "??..??.????. 1,1,1,1\n" +
            "?#?#???#?...# 2,5,1\n" +
            "#?.?.?.?.?#? 1,1,1,1\n" +
            "?#.?????#?#??#?##??. 1,2,12\n" +
            "??.??##.#?.?#.?. 1,2,1,2,1\n" +
            "?????#?.???.??.?? 1,3,2,1,1\n" +
            "??#???.??? 1,1\n" +
            ".#?...??.????#?????# 1,1,1,6,2\n" +
            "??????#????. 1,7\n" +
            "??????#????? 2,3,2\n" +
            "?????????##??????? 9,1\n" +
            "#?###???#??.???????# 5,3,1,2,2\n" +
            "??#?.?#????.??.. 4,1,1,2\n" +
            "?###?????# 7,1\n" +
            "??#.?#?###.? 1,1,6\n" +
            "??..???????? 1,1,1,1\n" +
            "?###?#???????#.. 9,2\n" +
            ".??.?.?????#?.#? 2,2,4,2\n" +
            "?..?#.?.?#???#??? 1,1,1,2,4\n" +
            "???#???????????.. 7,1\n" +
            "?#?##?#.??#?.##??? 1,4,3,3,1\n" +
            "?#???.???. 4,1\n" +
            "??????##?#?.#? 1,7,1\n" +
            "..?#?????.? 2,1,1\n" +
            "??#????#??#??#??? 10,4\n" +
            ".??#???#?#.?#??## 3,3,6\n" +
            "?##??###???..?##???? 8,1,3,2\n" +
            "?.?#?#?.?.????#??#?? 4,8\n" +
            "????????????#.. 1,8\n" +
            "#.?.????##???.?#. 1,1,1,6,1\n" +
            ".?##???????. 3,1\n" +
            ".???.??.???##? 2,1,3\n" +
            "????#???#.? 2,2\n" +
            "????.??#??#??#?#? 1,12\n" +
            "???#.??#?#???? 2,4\n" +
            "?#...??#???? 2,3\n" +
            "?#????#???? 1,3,2\n" +
            "???.###?#???# 1,5,2\n" +
            "?????#???#???#.?? 1,1,10,1\n" +
            "??##??#?????.??#? 12,3\n" +
            "?????????#?.?.#? 1,2,1,4,1\n" +
            "#???#??.#???##?? 2,1,1,5\n" +
            "?.?##???.. 3,1\n" +
            "???#?##?.?? 1,3,2\n" +
            "####.?????#???# 4,1,7\n" +
            "?????#????##? 1,7\n" +
            "?.?#??#.??#.??. 5,3\n" +
            "#???????.??? 4,1,1\n" +
            "???#????#.? 2,1\n" +
            ".##??.?.#####?.. 4,6\n" +
            "????#.?##.??.?## 4,2,2,2\n" +
            "???????.????##?? 5,1,2\n" +
            "?#?#???#?.# 1,6,1\n" +
            "???#.?.???????#?.#.? 1,1,1,9,1,1\n" +
            "?.#??#??.???? 1,1,1,1\n" +
            "?????#????#.?? 3,6,1\n" +
            "##???.#?.??#. 2,2,1,2\n" +
            "????.?#?#??????????? 4,1\n" +
            "??#??????#???.????? 5,1,2,1,1\n" +
            "??.?#..#????? 1,1,1,2\n" +
            "???.????##????#?.#? 1,1,10,2\n" +
            "?.#????#????.??#? 1,2,3,1,3\n" +
            "?###?.?###.?.#?? 4,4,2\n" +
            "#???????..??# 2,1,1,3\n" +
            "##?????##??#.?.???.# 12,2,1\n" +
            ".??????#.?.??#???? 5,1,1,1,1,1\n" +
            "??.???.?.?. 1,2,1\n" +
            "??#?#?##.?????? 6,3\n" +
            ".?.??.?#??? 2,1\n" +
            ".?.?##?#?##?.?.#? 1,9,2\n" +
            ".?????##?.? 1,5\n" +
            "??#???????#???. 3,7\n" +
            "??.?#?..??##??#?? 2,8\n" +
            "??##??.?#?#.?.?? 6,1,1,1,1\n" +
            "???#??????.? 2,1,1,1\n" +
            "??.????#..???.?#??? 1,1,1,1,2,5\n" +
            ".##?#???#??###?????. 6,10\n" +
            ".?.?.?.??##.. 1,2\n" +
            "??????#???#???? 1,2,2,1,4\n" +
            "?.?????.#??? 5,2\n" +
            "????#??###??.??.?#?? 1,8,2,2\n" +
            "?#????#????#??.??. 3,3,4,1\n" +
            "??#??..?.????.? 4,1\n" +
            ".#?#????#?#??? 5,1,3\n" +
            ".##????#????. 2,1,5\n" +
            "???#????#??.??#?#??? 1,2,4,1,1,1\n" +
            ".??#?#?????#?#????#? 1,1,1,12\n" +
            "?#.#.?.??.###?##??# 1,1,1,6,1\n" +
            "?.??????#?.????? 1,1,1,1,4\n" +
            "??????#????..?#?? 11,2\n" +
            "??##????????#..? 1,7,1,1,1\n" +
            "??.?###???. 1,5\n" +
            "????##?#?#???# 1,7,3\n" +
            "????#?????##?..??? 3,2,1\n" +
            "??#?????#?.??.??.? 1,8,1,2,1\n" +
            "??.?###?#??#?#??? 1,12\n" +
            "?#???????? 3,2\n" +
            ".???????..?##? 1,1,4\n" +
            "#?.???#??????#?#? 2,4,5\n" +
            "????#???#.. 1,1,2\n" +
            "??#???#?????.??.?#?? 3,1,2,1,2,1\n" +
            "..????.??? 1,1\n" +
            ".????#???#?? 1,3,1\n" +
            "???##.?.???.?? 5,1,1\n" +
            "?.?????.?????#???. 3,1,3\n" +
            "???.#??#????#???? 3,2,1,6\n" +
            "????##?.?? 1,4,1\n" +
            "???#????????#? 1,5\n" +
            "...#???##??????????? 2,12\n" +
            "#.?.??.????????? 1,2,1,2,1\n" +
            "????.?#.???#?. 1,2,1,2\n" +
            "??#???#.???# 2,1,1,1\n" +
            "?###.?.?.#?.# 3,1,1,1\n" +
            "####?..?##??# 5,6\n" +
            "?.?.#.?##????#? 1,1,3,3\n" +
            "?#.?#.?##?#..#?? 2,1,4,3\n" +
            "??.??????..??? 1,2,2,2\n" +
            "?????.?.#???.???#??. 4,3,5\n" +
            "?#??#??.???##. 6,4\n" +
            "???#?????? 3,1,1\n" +
            ".????????#??.???.?.? 10,1\n" +
            "?#?????????# 3,4,2\n" +
            ".#??.?#?##??.?? 2,7,1\n" +
            ".??#??.#.?.#???. 3,1,1,2\n" +
            "????.?????? 1,4\n" +
            "????#?????.??. 6,1,2\n" +
            "..#??#????#???? 9,2\n" +
            "?.?.??.#?? 1,3\n" +
            "?#?????#?.??????. 2,3,1,3\n" +
            "???????#.?????#? 1,2,6\n" +
            ".?.?.?.#??????.?. 1,3\n" +
            "##?###?##??#??????. 2,10,1\n" +
            "??###???.?#????????? 4,1,3,1,1\n" +
            "??##????.????#.?.? 6,1,1,1,1,1\n" +
            ".#?#???..??.#? 3,1,2,2\n" +
            "?#?#?##?#??#???#??? 2,7,1,5\n" +
            "???.?#??#??#?## 1,2,7\n" +
            "???????????.??? 1,8,1,1\n" +
            "..#?##????.? 4,1\n" +
            "#??##?#???#?#?#? 1,13\n" +
            "..#???????????.?? 1,1,1,5,1\n" +
            "??.??????.? 1,1\n" +
            "?#??.????.?.?.. 4,1,1,1,1\n" +
            "?????????##?#???? 5,8\n" +
            "#??.???????#?? 1,1,5,3\n" +
            "#?#???#?.??? 1,1,4,1\n" +
            "?..?#?.####.? 2,4\n" +
            ".???##.?##?#????. 1,2,3,3\n" +
            "?????.#?##??????? 1,11\n" +
            "?????##?#??#.?.????? 9,1,1,2,1\n" +
            "???##?#???? 5,2,1\n" +
            "???.???#??????# 1,1,1,2,5\n" +
            "???.???#?. 1,3\n" +
            "???##?????????. 5,3\n" +
            "?#?.#.??#.#???#? 1,1,2,1,2\n" +
            "?.?##?##.?.?.?#?? 5,4\n" +
            "?????.?.?#??.#????.? 5,2,2,1,1\n" +
            ".??.???##???????? 2,1,6,1,1\n" +
            ".?.??..#???. 1,1,1,1\n" +
            ".???.#.??#?? 1,1,1,2\n" +
            ".???.#.#??##?#?.# 2,1,2,4,1\n" +
            "?#.?.????.#? 1,1,1,2\n" +
            "??##?##??.????.?.?. 9,2,1\n" +
            "????..????#.? 1,4\n" +
            "?#??#????????#.????? 8,1,1,1,1\n" +
            "????#.??#???#. 4,1,2\n" +
            "?#?#??#???#. 5,1,1,1\n" +
            "??##?##??#???#.#? 10,2,1\n" +
            ".?#??.?##?.??#? 4,4,1,2\n" +
            "#???##.??.#?? 2,2,1,2\n" +
            ".????#??#????.??..# 9,2,1\n" +
            "?#?..?#????#??###? 1,2,7\n" +
            "#?.#..??#?.? 1,1,4\n" +
            "?#???#??.???#??#? 6,1,1,1\n" +
            ".?##???.??#?????? 3,7\n" +
            "??.??.?#????.?. 1,1,6,1\n" +
            "??#??#???.?#??.? 1,5,3,1\n" +
            "..??????#?.??#?##?.? 7,6\n" +
            "?#?????#???#?#?#?? 1,11\n" +
            ".?????.?????.#?#? 1,1,5,1,1\n" +
            "???#?.?#??? 3,4\n" +
            "?????.????.#??. 1,1,1,1,3\n" +
            "?#????.???#??#?????? 1,1,1,8,1\n" +
            "?#.#?????? 1,2,4\n" +
            "??#????????#?##???? 4,1,9\n" +
            "???.?.?????? 2,1,1,1\n" +
            "##???#?#????.#.????# 9,1,1,1,1,1\n" +
            "??.?????.?. 2,5,1\n" +
            "?.????????????.??. 1,4,2,1,1,1\n" +
            "#?#??#???#??? 1,1,1,2\n" +
            "?#??????#??#??# 2,1,1,1,5\n" +
            "#??#??#..???? 1,5,1,1\n" +
            "#...#?????.? 1,1,1,1\n" +
            "#?...????...??? 1,4,2\n" +
            "?##??.??..##???# 4,1,6\n" +
            "??..???### 1,4\n" +
            "?#.?.?????#?.???#? 1,1,1,1,3,4\n" +
            "###???#???#?##???#? 4,13\n" +
            "?#?????????? 3,4\n" +
            "?###?#????.?.#????# 10,1,1,1,1\n" +
            "????.?????#??. 3,7\n" +
            "?###???##?#?#.?#??? 9,3,3\n" +
            "??????.??????#???.? 2,4\n" +
            "?.?#????.? 3,1\n" +
            ".??##????????.????? 11,3\n" +
            "?.?????#??#?#???? 1,1,1,1,4\n" +
            "???.#?#?.????? 1,1,1,5\n" +
            "??#??.???#?. 1,3,2\n" +
            "??#...?#???? 2,6\n";

    public static void main(String[] args) {
        String[] ss = sq.split("\n");
        int sum = 0;
        for (int i = 0; i < ss.length; i++) {
            String x = ss[i].split(" ")[0];
            System.out.println(x + " ");
            String f = ss[i].split(" ")[1];
            int q = 0;
            for (int j = 0; j < x.length(); j++) {
                if (x.charAt(j) == '?') {
                    q++;
                }
            }
            int pow = (int) Math.pow(2, q);
            for (int j = 0; j < pow; j++) {
                String xx = x;
                int z = 0;
                String binary = prependZeroes(q, Integer.toBinaryString(j));
                for (int k = 0; k < xx.length(); k++) {
                    if (xx.charAt(k) == '?') {
                        if (binary.charAt(z) == '0') {
                            xx = xx.substring(0, k) + '.' + xx.substring(k + 1);
                        }
                        if (binary.charAt(z) == '1') {
                            xx = xx.substring(0, k) + '#' + xx.substring(k + 1);
                        }
                        z++;
                    }
                }
                if (check(xx, f)) {
                    sum++;
                }
            }
            System.out.println(sum);
        }
    }

    private static String prependZeroes(int len, String toBinaryString) {
        StringBuilder toBinaryStringBuilder = new StringBuilder(toBinaryString);
        int l = toBinaryString.length();
        for (int i = 0; i < len - l; i++) {
            toBinaryStringBuilder.insert(0, "0");
        }
        return toBinaryStringBuilder.toString();
    }

    private static boolean check(String xx, String f) {
        String[] xxx = xx.split("\\.");
        String[] fs = f.split(",");
        int k = 0;
        List<String> xxxx = new ArrayList<>();
        for (int i = 0; i < xxx.length; i++) {
            if (xxx[i].length() > 0) {
                xxxx.add(xxx[i]);
            }
        }
        if (xxxx.size() != fs.length) {
            return false;
        }

        for (String s : xxxx) {
            if (s.length() > 0 && k < fs.length) {
                if (Integer.parseInt(fs[k]) != s.length()) {
                    return false;
                }
                k++;
            }
        }
        System.out.println(xx + " " + f);
        return true;

    }

}
