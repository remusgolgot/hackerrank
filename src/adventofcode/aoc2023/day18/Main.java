package adventofcode.aoc2023.day18;

import java.util.*;

public class Main {
    static String s =
            "R 6 (#70c710)\n" +
                    "D 5 (#0dc571)\n" +
                    "L 2 (#5713f0)\n" +
                    "D 2 (#d2c081)\n" +
                    "R 2 (#59c680)\n" +
                    "D 2 (#411b91)\n" +
                    "L 5 (#8ceee2)\n" +
                    "U 2 (#caa173)\n" +
                    "L 1 (#1b58a2)\n" +
                    "U 2 (#caa171)\n" +
                    "R 2 (#7807d2)\n" +
                    "U 3 (#a77fa3)\n" +
                    "L 2 (#015232)\n" +
                    "U 2 (#7a21e3)";

    static String sq = "L 2 (#14c462)\n" +
            "U 2 (#2c7ad1)\n" +
            "L 3 (#4df5a2)\n" +
            "D 8 (#3d12c1)\n" +
            "L 6 (#3fbb82)\n" +
            "U 8 (#698d93)\n" +
            "L 3 (#076762)\n" +
            "U 4 (#3862b3)\n" +
            "L 5 (#321722)\n" +
            "D 6 (#39ac63)\n" +
            "L 6 (#90ac02)\n" +
            "U 6 (#430fb3)\n" +
            "L 3 (#90ac00)\n" +
            "U 5 (#2bae63)\n" +
            "L 4 (#23ae62)\n" +
            "U 4 (#0cfaa3)\n" +
            "L 5 (#6c6f92)\n" +
            "U 4 (#0c9523)\n" +
            "L 6 (#1f64b0)\n" +
            "D 3 (#4940f3)\n" +
            "L 3 (#2b1ee0)\n" +
            "D 5 (#4940f1)\n" +
            "L 4 (#497360)\n" +
            "D 5 (#2fe791)\n" +
            "L 4 (#00ff20)\n" +
            "U 5 (#264ec1)\n" +
            "L 4 (#0a7990)\n" +
            "D 3 (#0c38e1)\n" +
            "L 6 (#1e6270)\n" +
            "D 3 (#574d71)\n" +
            "L 6 (#61f5e0)\n" +
            "D 7 (#1546b1)\n" +
            "L 7 (#84ccd0)\n" +
            "U 6 (#1546b3)\n" +
            "L 2 (#0ebe60)\n" +
            "U 4 (#574d73)\n" +
            "L 7 (#11a670)\n" +
            "U 3 (#0c38e3)\n" +
            "L 3 (#373090)\n" +
            "U 2 (#563653)\n" +
            "L 3 (#0e88f0)\n" +
            "U 4 (#44fa43)\n" +
            "L 5 (#1859e2)\n" +
            "U 3 (#826cf3)\n" +
            "L 3 (#08e702)\n" +
            "U 7 (#2b00a3)\n" +
            "L 3 (#588072)\n" +
            "U 3 (#14d691)\n" +
            "R 6 (#375a42)\n" +
            "U 4 (#839211)\n" +
            "L 3 (#3b3182)\n" +
            "U 9 (#1504f1)\n" +
            "L 4 (#50bd72)\n" +
            "U 6 (#633e53)\n" +
            "L 5 (#2bfd62)\n" +
            "U 5 (#40a523)\n" +
            "L 3 (#1fe8e2)\n" +
            "U 5 (#5587c3)\n" +
            "L 3 (#6e31c2)\n" +
            "U 6 (#5587c1)\n" +
            "L 2 (#139092)\n" +
            "U 2 (#2b7bc3)\n" +
            "L 4 (#0ab700)\n" +
            "D 3 (#49cec3)\n" +
            "L 2 (#8d3e20)\n" +
            "D 7 (#4af703)\n" +
            "L 4 (#8c40c0)\n" +
            "U 3 (#4af701)\n" +
            "L 6 (#47dc10)\n" +
            "U 7 (#569683)\n" +
            "L 3 (#0fc2d0)\n" +
            "U 8 (#72f9a1)\n" +
            "L 6 (#65f950)\n" +
            "U 3 (#72f9a3)\n" +
            "L 3 (#3454e0)\n" +
            "U 7 (#4568a3)\n" +
            "L 6 (#008150)\n" +
            "U 5 (#118851)\n" +
            "L 8 (#53f690)\n" +
            "U 4 (#5d1af1)\n" +
            "R 5 (#5834e0)\n" +
            "U 5 (#09f4a1)\n" +
            "R 4 (#477310)\n" +
            "U 3 (#670f93)\n" +
            "R 4 (#1c6da0)\n" +
            "D 5 (#25a0a1)\n" +
            "R 2 (#59c4d0)\n" +
            "D 7 (#57ad91)\n" +
            "R 3 (#6725d0)\n" +
            "U 4 (#32c1e1)\n" +
            "R 5 (#48a750)\n" +
            "U 4 (#120951)\n" +
            "L 5 (#386970)\n" +
            "U 4 (#385811)\n" +
            "R 4 (#3946f0)\n" +
            "U 6 (#345561)\n" +
            "R 4 (#47aa02)\n" +
            "D 9 (#0eac91)\n" +
            "R 3 (#72adb2)\n" +
            "U 4 (#5b2a51)\n" +
            "R 2 (#4443e2)\n" +
            "U 4 (#693893)\n" +
            "R 3 (#482862)\n" +
            "U 8 (#083673)\n" +
            "L 3 (#3e9572)\n" +
            "U 4 (#66e623)\n" +
            "L 3 (#2463b2)\n" +
            "U 7 (#66e621)\n" +
            "L 3 (#253f42)\n" +
            "D 6 (#3cf531)\n" +
            "L 2 (#594ed2)\n" +
            "D 5 (#3479d1)\n" +
            "L 4 (#630352)\n" +
            "U 5 (#287a31)\n" +
            "L 5 (#691f60)\n" +
            "D 4 (#343571)\n" +
            "L 5 (#4166f0)\n" +
            "D 3 (#649291)\n" +
            "L 5 (#482f62)\n" +
            "U 7 (#3e0581)\n" +
            "L 4 (#482f60)\n" +
            "U 4 (#4946d1)\n" +
            "R 3 (#4166f2)\n" +
            "U 2 (#476c81)\n" +
            "R 6 (#698b20)\n" +
            "U 4 (#2d04a1)\n" +
            "R 9 (#329080)\n" +
            "U 2 (#139bc1)\n" +
            "R 4 (#268b80)\n" +
            "U 2 (#341471)\n" +
            "R 8 (#627680)\n" +
            "U 5 (#52faf1)\n" +
            "R 3 (#2e57b0)\n" +
            "U 3 (#015c91)\n" +
            "R 9 (#314930)\n" +
            "U 3 (#486bf1)\n" +
            "L 4 (#33c4c0)\n" +
            "U 5 (#5ba2f1)\n" +
            "L 2 (#1f7d00)\n" +
            "U 4 (#5108c3)\n" +
            "L 4 (#30fb90)\n" +
            "D 6 (#782833)\n" +
            "L 2 (#30fb92)\n" +
            "D 3 (#057753)\n" +
            "L 4 (#85a3b0)\n" +
            "U 6 (#28b061)\n" +
            "L 5 (#1e1f20)\n" +
            "U 4 (#2b3311)\n" +
            "L 3 (#0202f0)\n" +
            "D 4 (#2e3b83)\n" +
            "L 4 (#5dfcc0)\n" +
            "D 7 (#2e3b81)\n" +
            "L 3 (#489d50)\n" +
            "D 4 (#2b26c1)\n" +
            "L 3 (#050062)\n" +
            "U 3 (#4cfae1)\n" +
            "L 7 (#566a92)\n" +
            "U 5 (#16f203)\n" +
            "R 7 (#6ac902)\n" +
            "U 7 (#16f201)\n" +
            "L 5 (#008832)\n" +
            "U 2 (#02a331)\n" +
            "L 3 (#2a1b10)\n" +
            "U 5 (#1ef761)\n" +
            "R 5 (#42a490)\n" +
            "U 4 (#6a4b51)\n" +
            "R 4 (#29ca80)\n" +
            "U 4 (#5df141)\n" +
            "R 4 (#4fd6e0)\n" +
            "U 2 (#3f26a1)\n" +
            "R 5 (#5240b0)\n" +
            "D 4 (#49fd11)\n" +
            "R 2 (#5fde00)\n" +
            "D 2 (#4df411)\n" +
            "R 8 (#632fa0)\n" +
            "U 2 (#58b203)\n" +
            "R 6 (#763ea0)\n" +
            "U 8 (#4f9593)\n" +
            "R 6 (#3fd0e0)\n" +
            "U 3 (#2915a1)\n" +
            "R 2 (#672e40)\n" +
            "U 3 (#0e7de3)\n" +
            "L 5 (#2d3c20)\n" +
            "U 3 (#0e7de1)\n" +
            "L 5 (#5a6530)\n" +
            "U 6 (#2915a3)\n" +
            "L 8 (#0388f0)\n" +
            "D 5 (#1f45c3)\n" +
            "L 3 (#102312)\n" +
            "D 4 (#388f03)\n" +
            "L 3 (#464562)\n" +
            "D 5 (#4166e3)\n" +
            "L 6 (#525992)\n" +
            "U 5 (#3a4f13)\n" +
            "L 3 (#6b2682)\n" +
            "U 4 (#3ffce3)\n" +
            "R 3 (#1333d2)\n" +
            "U 4 (#3d0023)\n" +
            "R 4 (#814bb2)\n" +
            "U 8 (#348ff3)\n" +
            "R 4 (#5d3560)\n" +
            "U 4 (#2d57e3)\n" +
            "R 3 (#2eb8a0)\n" +
            "U 4 (#07eb73)\n" +
            "R 6 (#4ae2e0)\n" +
            "D 4 (#07eb71)\n" +
            "R 6 (#360740)\n" +
            "U 5 (#8c7361)\n" +
            "R 3 (#444c70)\n" +
            "U 3 (#8c7363)\n" +
            "L 3 (#2c9140)\n" +
            "U 5 (#557cb3)\n" +
            "L 5 (#045b50)\n" +
            "D 6 (#41ed33)\n" +
            "L 6 (#13dae0)\n" +
            "U 6 (#44fb13)\n" +
            "L 4 (#6e5e40)\n" +
            "U 5 (#54e963)\n" +
            "R 8 (#1d5d32)\n" +
            "U 4 (#6497a3)\n" +
            "R 8 (#3b7aa2)\n" +
            "U 3 (#704013)\n" +
            "R 3 (#3f6182)\n" +
            "D 5 (#16a6e1)\n" +
            "R 6 (#2f2ad2)\n" +
            "D 3 (#599931)\n" +
            "R 6 (#3f2692)\n" +
            "D 4 (#386973)\n" +
            "R 5 (#05d992)\n" +
            "D 9 (#2d8eb1)\n" +
            "R 3 (#30d2b2)\n" +
            "D 3 (#835cd1)\n" +
            "L 4 (#0e39d2)\n" +
            "D 2 (#1810a3)\n" +
            "L 3 (#4700f2)\n" +
            "D 4 (#779b13)\n" +
            "R 3 (#543d32)\n" +
            "D 4 (#213fd3)\n" +
            "R 4 (#1d9b62)\n" +
            "D 5 (#5858e3)\n" +
            "R 6 (#043810)\n" +
            "D 2 (#0a40d3)\n" +
            "R 3 (#4acc12)\n" +
            "U 3 (#48dd53)\n" +
            "R 5 (#1aade2)\n" +
            "U 4 (#3d1883)\n" +
            "L 5 (#3ef1d2)\n" +
            "U 3 (#0e0813)\n" +
            "R 5 (#08b482)\n" +
            "U 4 (#132433)\n" +
            "R 5 (#2fc940)\n" +
            "D 5 (#1a93f3)\n" +
            "R 5 (#7a22a0)\n" +
            "D 5 (#36bc03)\n" +
            "R 3 (#033460)\n" +
            "D 7 (#4a6b63)\n" +
            "R 7 (#043812)\n" +
            "D 4 (#480c93)\n" +
            "L 7 (#50c0b0)\n" +
            "D 2 (#352f93)\n" +
            "L 3 (#50c0b2)\n" +
            "D 3 (#19ce43)\n" +
            "L 7 (#1773e0)\n" +
            "D 2 (#095061)\n" +
            "L 4 (#47c220)\n" +
            "D 4 (#639411)\n" +
            "L 3 (#1329c0)\n" +
            "D 5 (#64bc71)\n" +
            "L 6 (#4b39d0)\n" +
            "D 7 (#703ce3)\n" +
            "L 6 (#22ad10)\n" +
            "U 7 (#703ce1)\n" +
            "L 3 (#3be080)\n" +
            "D 7 (#1b6241)\n" +
            "L 5 (#07e612)\n" +
            "D 4 (#070e03)\n" +
            "R 8 (#064ec2)\n" +
            "D 6 (#16df21)\n" +
            "R 6 (#424922)\n" +
            "D 8 (#528ca1)\n" +
            "R 3 (#32d9b2)\n" +
            "U 2 (#696bc3)\n" +
            "R 2 (#1d43d2)\n" +
            "U 9 (#070e01)\n" +
            "R 5 (#1c55b2)\n" +
            "U 3 (#0302f1)\n" +
            "R 3 (#47c222)\n" +
            "D 2 (#61ace1)\n" +
            "R 2 (#4b5fc0)\n" +
            "D 9 (#303f51)\n" +
            "R 5 (#0a8cd0)\n" +
            "D 4 (#6107c1)\n" +
            "R 5 (#7cfe30)\n" +
            "D 6 (#6107c3)\n" +
            "R 5 (#3298c0)\n" +
            "U 3 (#6abc21)\n" +
            "R 7 (#0c93d0)\n" +
            "U 2 (#0c4433)\n" +
            "R 4 (#479520)\n" +
            "U 4 (#00c1b3)\n" +
            "R 3 (#4fa0c2)\n" +
            "U 4 (#445be3)\n" +
            "R 4 (#109090)\n" +
            "U 5 (#3d1673)\n" +
            "R 4 (#109092)\n" +
            "D 3 (#1def43)\n" +
            "R 2 (#4fa0c0)\n" +
            "D 5 (#343043)\n" +
            "R 6 (#12e780)\n" +
            "D 4 (#1f46a1)\n" +
            "R 3 (#025fe0)\n" +
            "D 6 (#039dc1)\n" +
            "R 3 (#095c62)\n" +
            "D 3 (#889511)\n" +
            "R 5 (#095c60)\n" +
            "D 4 (#070791)\n" +
            "R 3 (#4a79e0)\n" +
            "D 2 (#190141)\n" +
            "R 6 (#251260)\n" +
            "D 5 (#151571)\n" +
            "R 3 (#5c6b80)\n" +
            "D 9 (#52a8f1)\n" +
            "R 4 (#193440)\n" +
            "U 8 (#30c561)\n" +
            "R 3 (#2ff770)\n" +
            "U 2 (#4fa271)\n" +
            "R 3 (#838710)\n" +
            "U 6 (#40a201)\n" +
            "R 3 (#4181e0)\n" +
            "U 4 (#2373c1)\n" +
            "R 3 (#1134c0)\n" +
            "U 2 (#4a7701)\n" +
            "R 3 (#321830)\n" +
            "U 5 (#16ed61)\n" +
            "R 2 (#3519b0)\n" +
            "U 5 (#0def01)\n" +
            "R 3 (#46d6d0)\n" +
            "D 8 (#2deb71)\n" +
            "R 2 (#19a802)\n" +
            "D 4 (#2590a1)\n" +
            "R 4 (#19a800)\n" +
            "U 2 (#48d051)\n" +
            "R 2 (#41fe90)\n" +
            "U 3 (#053ff1)\n" +
            "R 2 (#1f4910)\n" +
            "U 4 (#637f31)\n" +
            "R 7 (#4b8410)\n" +
            "U 2 (#637f33)\n" +
            "R 2 (#334720)\n" +
            "U 5 (#1b4501)\n" +
            "L 9 (#4b72e0)\n" +
            "U 3 (#205173)\n" +
            "L 6 (#102f52)\n" +
            "U 2 (#0513b3)\n" +
            "L 5 (#41efb2)\n" +
            "U 3 (#0513b1)\n" +
            "R 3 (#494c82)\n" +
            "U 5 (#39c653)\n" +
            "R 4 (#4a7ad0)\n" +
            "U 5 (#1cd0e3)\n" +
            "L 7 (#3328b0)\n" +
            "U 5 (#1cd0e1)\n" +
            "L 4 (#1dc800)\n" +
            "U 3 (#4b1353)\n" +
            "L 6 (#4bdf40)\n" +
            "U 3 (#4be641)\n" +
            "L 6 (#8767b2)\n" +
            "U 2 (#263291)\n" +
            "L 9 (#8767b0)\n" +
            "U 5 (#331241)\n" +
            "R 5 (#191780)\n" +
            "U 7 (#1b4503)\n" +
            "R 4 (#8043a0)\n" +
            "D 7 (#011f91)\n" +
            "R 6 (#050a62)\n" +
            "U 6 (#44c921)\n" +
            "R 3 (#2d5660)\n" +
            "U 6 (#1262f3)\n" +
            "R 6 (#3d2610)\n" +
            "D 6 (#760083)\n" +
            "R 5 (#2e26d0)\n" +
            "D 4 (#886371)\n" +
            "R 5 (#086c30)\n" +
            "D 4 (#2569a1)\n" +
            "R 3 (#0b53f2)\n" +
            "D 3 (#4c7aa1)\n" +
            "R 5 (#7a5ae2)\n" +
            "U 4 (#4c7aa3)\n" +
            "R 5 (#1b60a2)\n" +
            "U 5 (#593691)\n" +
            "R 2 (#2c4672)\n" +
            "U 8 (#046361)\n" +
            "R 5 (#241f82)\n" +
            "D 5 (#4cd8e1)\n" +
            "R 4 (#71db42)\n" +
            "D 2 (#007333)\n" +
            "R 6 (#1023f2)\n" +
            "D 4 (#5aaab3)\n" +
            "R 5 (#751b30)\n" +
            "D 4 (#114df3)\n" +
            "R 3 (#256e90)\n" +
            "D 6 (#0b94e3)\n" +
            "R 8 (#01e062)\n" +
            "D 5 (#30f9a3)\n" +
            "R 8 (#4385d2)\n" +
            "D 6 (#3c7253)\n" +
            "R 3 (#14f0e2)\n" +
            "D 5 (#3c7251)\n" +
            "L 4 (#4032b2)\n" +
            "D 3 (#413b53)\n" +
            "L 3 (#532582)\n" +
            "D 2 (#039301)\n" +
            "L 7 (#3741a2)\n" +
            "D 5 (#481d31)\n" +
            "L 5 (#555ce2)\n" +
            "D 4 (#1d90b1)\n" +
            "R 2 (#555ce0)\n" +
            "D 4 (#4868d1)\n" +
            "R 7 (#3741a0)\n" +
            "D 3 (#388bf1)\n" +
            "R 6 (#4b8942)\n" +
            "D 3 (#153683)\n" +
            "L 6 (#74d142)\n" +
            "D 2 (#35d6f3)\n" +
            "L 4 (#3556a2)\n" +
            "D 5 (#36f023)\n" +
            "R 7 (#82df02)\n" +
            "D 4 (#344bc3)\n" +
            "R 3 (#0b67e2)\n" +
            "D 4 (#5e5c43)\n" +
            "R 5 (#54ced2)\n" +
            "D 3 (#515e41)\n" +
            "R 8 (#447c22)\n" +
            "D 3 (#001093)\n" +
            "R 5 (#01f5f0)\n" +
            "D 2 (#636943)\n" +
            "R 5 (#01f5f2)\n" +
            "D 4 (#3a76b3)\n" +
            "R 7 (#400d72)\n" +
            "D 2 (#690fc1)\n" +
            "R 4 (#5df132)\n" +
            "D 5 (#34e0c1)\n" +
            "R 3 (#019872)\n" +
            "D 3 (#139c51)\n" +
            "R 6 (#257832)\n" +
            "D 7 (#3763c1)\n" +
            "R 2 (#3812b2)\n" +
            "D 2 (#4abb01)\n" +
            "R 5 (#415d30)\n" +
            "D 8 (#5d9801)\n" +
            "R 4 (#3cf760)\n" +
            "D 3 (#2e38e1)\n" +
            "R 7 (#228c80)\n" +
            "D 6 (#0514d1)\n" +
            "R 3 (#4a4ed0)\n" +
            "D 4 (#8345d3)\n" +
            "R 4 (#3291b0)\n" +
            "D 6 (#8345d1)\n" +
            "R 4 (#23dc80)\n" +
            "D 4 (#2994b1)\n" +
            "R 7 (#91aaa2)\n" +
            "D 5 (#27d241)\n" +
            "R 7 (#478cd0)\n" +
            "U 5 (#039a81)\n" +
            "R 3 (#3d69a0)\n" +
            "U 3 (#74fa61)\n" +
            "L 6 (#5d1a40)\n" +
            "U 2 (#61bca3)\n" +
            "L 7 (#13c980)\n" +
            "U 3 (#043a43)\n" +
            "R 3 (#03d8c0)\n" +
            "U 7 (#91c303)\n" +
            "R 4 (#03d8c2)\n" +
            "D 7 (#030563)\n" +
            "R 6 (#1fb0b0)\n" +
            "U 5 (#0d0951)\n" +
            "R 5 (#737fc0)\n" +
            "D 7 (#1e8341)\n" +
            "R 6 (#0a4e50)\n" +
            "D 5 (#6d2ca1)\n" +
            "L 6 (#365370)\n" +
            "D 6 (#13fee1)\n" +
            "R 4 (#4a4770)\n" +
            "D 3 (#4e0731)\n" +
            "R 6 (#0ee5b0)\n" +
            "D 6 (#929f11)\n" +
            "R 4 (#09ea52)\n" +
            "D 3 (#16e011)\n" +
            "R 4 (#066812)\n" +
            "D 7 (#464813)\n" +
            "R 7 (#64f0d2)\n" +
            "D 4 (#2ea2c3)\n" +
            "R 9 (#5b3a22)\n" +
            "D 4 (#355681)\n" +
            "L 4 (#411f72)\n" +
            "D 4 (#355683)\n" +
            "L 6 (#68d842)\n" +
            "D 4 (#74ead1)\n" +
            "L 3 (#236e12)\n" +
            "D 9 (#63fb41)\n" +
            "R 2 (#03f510)\n" +
            "D 5 (#246351)\n" +
            "R 7 (#0cbab0)\n" +
            "D 3 (#0b25e1)\n" +
            "R 4 (#37c400)\n" +
            "D 5 (#66efc1)\n" +
            "L 6 (#3711e0)\n" +
            "D 8 (#0f38d1)\n" +
            "L 6 (#5fd820)\n" +
            "D 6 (#37fb81)\n" +
            "L 7 (#2cd430)\n" +
            "D 5 (#41ef01)\n" +
            "L 4 (#3be180)\n" +
            "D 9 (#59e231)\n" +
            "L 5 (#46d042)\n" +
            "U 4 (#2808a1)\n" +
            "L 4 (#7ed982)\n" +
            "U 3 (#2808a3)\n" +
            "L 8 (#02e412)\n" +
            "U 4 (#0e4461)\n" +
            "R 6 (#1df4d2)\n" +
            "U 4 (#777bd3)\n" +
            "R 6 (#54d942)\n" +
            "U 5 (#1985e3)\n" +
            "L 9 (#02ba42)\n" +
            "D 3 (#6c0593)\n" +
            "L 6 (#35c202)\n" +
            "D 3 (#4f2cc1)\n" +
            "L 4 (#1451e2)\n" +
            "D 4 (#6b2353)\n" +
            "L 4 (#4e3322)\n" +
            "D 7 (#3165f3)\n" +
            "L 7 (#362502)\n" +
            "U 3 (#0406b1)\n" +
            "R 4 (#31ba80)\n" +
            "U 11 (#687fc1)\n" +
            "L 4 (#31ba82)\n" +
            "U 3 (#266d41)\n" +
            "L 7 (#2254b2)\n" +
            "D 7 (#099591)\n" +
            "R 5 (#22e172)\n" +
            "D 3 (#4f2cc3)\n" +
            "L 5 (#25cf42)\n" +
            "D 7 (#25cf11)\n" +
            "L 7 (#53c282)\n" +
            "D 7 (#71a631)\n" +
            "L 8 (#642fc2)\n" +
            "D 7 (#1cfee3)\n" +
            "R 8 (#4dfc42)\n" +
            "D 2 (#1c01a3)\n" +
            "R 2 (#29d642)\n" +
            "D 6 (#821af3)\n" +
            "R 7 (#479fd2)\n" +
            "U 6 (#8aeeb1)\n" +
            "R 5 (#151a22)\n" +
            "D 6 (#0c89d1)\n" +
            "R 3 (#0e3580)\n" +
            "D 5 (#73f5b1)\n" +
            "R 3 (#0e3582)\n" +
            "D 8 (#35ca91)\n" +
            "R 7 (#307fe2)\n" +
            "U 8 (#07c433)\n" +
            "R 5 (#503032)\n" +
            "D 5 (#4b9c23)\n" +
            "R 3 (#448562)\n" +
            "D 3 (#34adb3)\n" +
            "L 5 (#448560)\n" +
            "D 5 (#606d23)\n" +
            "L 4 (#59c932)\n" +
            "D 6 (#58bda3)\n" +
            "R 4 (#4d7242)\n" +
            "D 4 (#3b31c1)\n" +
            "L 4 (#2c0a82)\n" +
            "D 9 (#7fe9b1)\n" +
            "L 2 (#359422)\n" +
            "D 3 (#72d833)\n" +
            "L 7 (#1b6982)\n" +
            "D 7 (#249d13)\n" +
            "L 2 (#628722)\n" +
            "D 3 (#460c83)\n" +
            "L 3 (#1ec4c2)\n" +
            "D 4 (#243a03)\n" +
            "L 6 (#262992)\n" +
            "D 2 (#0f01c1)\n" +
            "L 6 (#489f52)\n" +
            "U 2 (#148513)\n" +
            "L 4 (#24b5c2)\n" +
            "U 7 (#148511)\n" +
            "L 4 (#33a462)\n" +
            "U 3 (#5b44c1)\n" +
            "R 8 (#0624a2)\n" +
            "U 4 (#28ff73)\n" +
            "L 8 (#6fcad2)\n" +
            "U 5 (#532963)\n" +
            "R 4 (#08f720)\n" +
            "U 6 (#1e83e1)\n" +
            "L 8 (#7dc260)\n" +
            "D 7 (#1e83e3)\n" +
            "L 2 (#28fd80)\n" +
            "D 6 (#64ea33)\n" +
            "L 2 (#3ad382)\n" +
            "D 10 (#53a2e3)\n" +
            "L 2 (#74e382)\n" +
            "D 4 (#2e4203)\n" +
            "L 4 (#294a22)\n" +
            "U 8 (#0e1893)\n" +
            "L 7 (#6d8952)\n" +
            "U 8 (#0e1891)\n" +
            "L 4 (#143622)\n" +
            "U 4 (#3387d3)\n" +
            "L 4 (#514b72)\n" +
            "D 7 (#155673)\n" +
            "L 5 (#090c80)\n" +
            "U 7 (#2593e3)\n" +
            "L 5 (#1ac3f0)\n" +
            "U 5 (#67b7f3)\n" +
            "L 9 (#75f9c0)\n" +
            "U 6 (#047aa3)\n" +
            "L 4 (#089502)\n" +
            "U 4 (#0f61b3)\n" +
            "L 4 (#648f42)\n" +
            "U 5 (#0f61b1)\n" +
            "L 3 (#2ca5f2)\n" +
            "U 2 (#1220d3)\n" +
            "L 7 (#514b70)\n" +
            "U 3 (#56e323)\n" +
            "L 5 (#5064d2)\n" +
            "U 2 (#0ddfa3)\n" +
            "L 7 (#916d52)\n" +
            "U 4 (#488513)\n" +
            "L 3 (#60ea32)\n" +
            "U 7 (#1eed43)\n" +
            "L 4 (#3b93b2)\n" +
            "U 3 (#6eda73)\n" +
            "L 6 (#3b93b0)\n" +
            "U 4 (#3451a3)\n" +
            "L 9 (#60ea30)\n" +
            "U 5 (#6d4483)\n" +
            "R 4 (#491a32)\n" +
            "U 2 (#1e21c3)\n" +
            "R 11 (#6564c0)\n" +
            "U 3 (#3790a1)\n" +
            "L 3 (#0b3840)\n" +
            "U 6 (#3790a3)\n" +
            "L 2 (#69ea80)\n" +
            "U 5 (#1819f3)\n" +
            "L 2 (#183472)\n" +
            "U 3 (#57d363)\n" +
            "L 5 (#5e17a2)\n" +
            "U 6 (#484041)\n" +
            "L 4 (#23c202)\n" +
            "D 6 (#484043)\n" +
            "L 6 (#44cdb2)\n" +
            "U 3 (#173003)\n" +
            "L 5 (#3a4f72)\n" +
            "U 5 (#207781)\n" +
            "L 5 (#471b52)\n" +
            "U 6 (#207783)\n" +
            "L 3 (#128cf2)\n" +
            "U 8 (#49dea3)\n";

    public static void main(String[] args) {
        String[] ss = s.split("\n");
        Set<String> set = new HashSet<>();
        set.add("0,0");
        int x = 0;
        int y = 0;
        for (int i = 0; i < ss.length; i++) {
            String t = ss[i];
            String dir = t.split(" ")[0];
            String nr = t.split(" ")[1];
            if (dir.equals("R")) {
                for (int j = 0; j < Integer.parseInt(nr); j++) {
                    set.add(x + "," + ++y);
                }
            }
            if (dir.equals("L")) {
                for (int j = 0; j < Integer.parseInt(nr); j++) {
                    set.add(x + "," + --y);
                }
            }
            if (dir.equals("U")) {
                for (int j = 0; j < Integer.parseInt(nr); j++) {
                    set.add(--x + "," + y);
                }
            }
            if (dir.equals("D")) {
                for (int j = 0; j < Integer.parseInt(nr); j++) {
                    set.add(++x + "," + y);
                }
            }
        }
        int xmax = 0, ymax = 0;
        for (String t : set) {
            String u = t.split(",")[0];
            String v = t.split(",")[1];
            if (Integer.parseInt(u) > xmax) {
                xmax = Integer.parseInt(u);
            }
            if (Integer.parseInt(v) > ymax) {
                ymax = Integer.parseInt(v);
            }
        }
        int[][] mat = new int[xmax + 301][ymax + 301];
        for (String t : set) {
            int u = Integer.parseInt(t.split(",")[0]);
            int v = Integer.parseInt(t.split(",")[1]);
            mat[u + 300][v + 300] = 1;
        }
        int k = 0;
        int sol = 0;
        for (int i = 0; i < mat.length; i++) {
            int j = 0;
            while (j < mat[0].length && mat[i][j] == 0) {
                j++;
            }
            int sy = j;

            j = mat[0].length - 1;
            while (j >= 0 && mat[i][j] == 0) {
                j--;
            }
            int ey = j;
            if (ey > sy) {
                sol += (ey - sy + 1);
            }
        }
        System.out.println(set.size());
        System.out.println(k);
        System.out.println(sol);
        // 25720 too low
        // 62293 too high
    }

}
